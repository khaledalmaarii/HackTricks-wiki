# ì•¡ì„¸ìŠ¤ í† í°

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)ë¥¼ í†µí•´ ì œë¡œë¶€í„° ì˜ì›…ì´ ë˜ëŠ” AWS í•´í‚¹ì„ ë°°ìš°ì„¸ìš”</strong></summary>

* **ì‚¬ì´ë²„ ë³´ì•ˆ íšŒì‚¬**ì—ì„œ ì¼í•˜ì‹œë‚˜ìš”? **HackTricksì— ê·€ì‚¬ë¥¼ ê´‘ê³ í•˜ê³  ì‹¶ìœ¼ì‹ ê°€ìš”**? ì•„ë‹ˆë©´ **PEASSì˜ ìµœì‹  ë²„ì „ì— ì•¡ì„¸ìŠ¤í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œ**í•˜ê³  ì‹¶ìœ¼ì‹ ê°€ìš”? [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•´ë³´ì„¸ìš”, ì €í¬ì˜ ë…ì ì ì¸ [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™¹**](https://peass.creator-spring.com)ì„ ë°›ì•„ë³´ì„¸ìš”
* **[ğŸ’¬](https://emojipedia.org/speech-balloon/) Discord ê·¸ë£¹**ì— **ê°€ì…**í•˜ê±°ë‚˜ [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°**í•˜ì„¸ìš”.
* **í•´í‚¹ ìš”ë ¹ì„ ê³µìœ í•˜ê³  ì‹¶ìœ¼ì‹œë‹¤ë©´** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ë°** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ì— PRì„ ì œì¶œ**í•´ì£¼ì„¸ìš”.

</details>

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io)ì€ **ë‹¤í¬ ì›¹**ì„ í™œìš©í•œ ê²€ìƒ‰ ì—”ì§„ìœ¼ë¡œ, íšŒì‚¬ë‚˜ ê·¸ ê³ ê°ì´ **ìŠ¤í‹¸ëŸ¬ ì•…ì„± ì†Œí”„íŠ¸ì›¨ì–´**ì— ì˜í•´ **ì¹¨í•´**ë‹¹í–ˆëŠ”ì§€ ë¬´ë£Œë¡œ í™•ì¸í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

WhiteIntelì˜ ì£¼ìš” ëª©í‘œëŠ” ì •ë³´ë¥¼ ë„ë‚œí•˜ëŠ” ì•…ì„± ì†Œí”„íŠ¸ì›¨ì–´ë¡œ ì¸í•œ ê³„ì • íƒˆì·¨ ë° ëœì„¬ì›¨ì–´ ê³µê²©ì„ ë§‰ëŠ” ê²ƒì…ë‹ˆë‹¤.

ê·¸ë“¤ì˜ ì›¹ì‚¬ì´íŠ¸ë¥¼ ë°©ë¬¸í•˜ì—¬ ì—”ì§„ì„ **ë¬´ë£Œë¡œ** ì‹œí—˜í•´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% embed url="https://whiteintel.io" %}

***

## ì•¡ì„¸ìŠ¤ í† í°

ì‹œìŠ¤í…œì— **ë¡œê·¸ì¸í•œ ê° ì‚¬ìš©ìëŠ” í•´ë‹¹ ë¡œê·¸ì˜¨ ì„¸ì…˜ì— ëŒ€í•œ ë³´ì•ˆ ì •ë³´ë¥¼ í¬í•¨í•œ ì•¡ì„¸ìŠ¤ í† í°ì„ ë³´ìœ **í•©ë‹ˆë‹¤. ì‚¬ìš©ìê°€ ë¡œê·¸ì˜¨í•  ë•Œ ì‹œìŠ¤í…œì€ ì•¡ì„¸ìŠ¤ í† í°ì„ ìƒì„±í•©ë‹ˆë‹¤. ì‚¬ìš©ìë¥¼ ëŒ€ì‹ í•˜ì—¬ **ì‹¤í–‰ëœ ëª¨ë“  í”„ë¡œì„¸ìŠ¤ì—ëŠ” ì•¡ì„¸ìŠ¤ í† í°ì˜ ì‚¬ë³¸**ì´ ìˆìŠµë‹ˆë‹¤. í† í°ì€ ì‚¬ìš©ì, ì‚¬ìš©ìì˜ ê·¸ë£¹ ë° ì‚¬ìš©ìì˜ ê¶Œí•œì„ ì‹ë³„í•©ë‹ˆë‹¤. ë˜í•œ í† í°ì—ëŠ” í˜„ì¬ ë¡œê·¸ì˜¨ ì„¸ì…˜ì„ ì‹ë³„í•˜ëŠ” ë¡œê·¸ì˜¨ SID(ë³´ì•ˆ ì‹ë³„ì)ë„ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

ì´ ì •ë³´ëŠ” `whoami /all`ì„ ì‹¤í–‰í•˜ì—¬ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```
whoami /all

USER INFORMATION
----------------

User Name             SID
===================== ============================================
desktop-rgfrdxl\cpolo S-1-5-21-3359511372-53430657-2078432294-1001


GROUP INFORMATION
-----------------

Group Name                                                    Type             SID                                                                                                           Attributes
============================================================= ================ ============================================================================================================= ==================================================
Mandatory Label\Medium Mandatory Level                        Label            S-1-16-8192
Everyone                                                      Well-known group S-1-1-0                                                                                                       Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Local account and member of Administrators group Well-known group S-1-5-114                                                                                                     Group used for deny only
BUILTIN\Administrators                                        Alias            S-1-5-32-544                                                                                                  Group used for deny only
BUILTIN\Users                                                 Alias            S-1-5-32-545                                                                                                  Mandatory group, Enabled by default, Enabled group
BUILTIN\Performance Log Users                                 Alias            S-1-5-32-559                                                                                                  Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\INTERACTIVE                                      Well-known group S-1-5-4                                                                                                       Mandatory group, Enabled by default, Enabled group
CONSOLE LOGON                                                 Well-known group S-1-2-1                                                                                                       Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Authenticated Users                              Well-known group S-1-5-11                                                                                                      Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\This Organization                                Well-known group S-1-5-15                                                                                                      Mandatory group, Enabled by default, Enabled group
MicrosoftAccount\cpolop@outlook.com                           User             S-1-11-96-3623454863-58364-18864-2661722203-1597581903-3158937479-2778085403-3651782251-2842230462-2314292098 Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Local account                                    Well-known group S-1-5-113                                                                                                     Mandatory group, Enabled by default, Enabled group
LOCAL                                                         Well-known group S-1-2-0                                                                                                       Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Cloud Account Authentication                     Well-known group S-1-5-64-36                                                                                                   Mandatory group, Enabled by default, Enabled group


PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                          State
============================= ==================================== ========
SeShutdownPrivilege           Shut down the system                 Disabled
SeChangeNotifyPrivilege       Bypass traverse checking             Enabled
SeUndockPrivilege             Remove computer from docking station Disabled
SeIncreaseWorkingSetPrivilege Increase a process working set       Disabled
SeTimeZonePrivilege           Change the time zone                 Disabled
```
or using _Process Explorer_ from Sysinternals (select process and access"Security" tab):

![](<../../.gitbook/assets/image (772).png>)

### ë¡œì»¬ ê´€ë¦¬ì

ë¡œì»¬ ê´€ë¦¬ìê°€ ë¡œê·¸ì¸í•˜ë©´ **ë‘ ê°œì˜ ì•¡ì„¸ìŠ¤ í† í°ì´ ìƒì„±**ë©ë‹ˆë‹¤: í•˜ë‚˜ëŠ” ê´€ë¦¬ì ê¶Œí•œì´ ìˆê³  ë‹¤ë¥¸ í•˜ë‚˜ëŠ” ì¼ë°˜ ê¶Œí•œì´ ìˆìŠµë‹ˆë‹¤. **ê¸°ë³¸ì ìœ¼ë¡œ** ì´ ì‚¬ìš©ìê°€ í”„ë¡œì„¸ìŠ¤ë¥¼ ì‹¤í–‰í•  ë•ŒëŠ” **ì¼ë°˜**(ê´€ë¦¬ìê°€ ì•„ë‹Œ) **ê¶Œí•œì´ ì‚¬ìš©**ë©ë‹ˆë‹¤. ì´ ì‚¬ìš©ìê°€ ê´€ë¦¬ìë¡œ **ì‹¤í–‰**í•˜ë ¤ê³  í•  ë•Œ("ê´€ë¦¬ìë¡œ ì‹¤í–‰" ì˜ˆë¥¼ ë“¤ì–´) **UAC**ê°€ ê¶Œí•œì„ ìš”ì²­í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤.\
[**UACì— ëŒ€í•´ ë” ì•Œì•„ë³´ë ¤ë©´ ì´ í˜ì´ì§€ë¥¼ ì½ì–´ë³´ì„¸ìš”**](../authentication-credentials-uac-and-efs/#uac)**.**

### ìê²© ì¦ëª… ì‚¬ìš©ì ìœ„ì¥

ë‹¤ë¥¸ ì‚¬ìš©ìì˜ **ìœ íš¨í•œ ìê²© ì¦ëª…**ì´ ìˆë‹¤ë©´ í•´ë‹¹ ìê²© ì¦ëª…ìœ¼ë¡œ **ìƒˆë¡œìš´ ë¡œê·¸ì˜¨ ì„¸ì…˜ì„ ìƒì„±**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```
runas /user:domain\username cmd.exe
```
**ì•¡ì„¸ìŠ¤ í† í°**ì—ëŠ” **LSASS** ë‚´ì˜ ë¡œê·¸ì˜¨ ì„¸ì…˜ì— ëŒ€í•œ **ì°¸ì¡°**ë„ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” í”„ë¡œì„¸ìŠ¤ê°€ ë„¤íŠ¸ì›Œí¬ì˜ ì¼ë¶€ ê°ì²´ì— ì•¡ì„¸ìŠ¤í•´ì•¼ í•˜ëŠ” ê²½ìš° ìœ ìš©í•©ë‹ˆë‹¤.\
ë„¤íŠ¸ì›Œí¬ ì„œë¹„ìŠ¤ì— ì•¡ì„¸ìŠ¤í•˜ëŠ” ë° **ë‹¤ë¥¸ ìê²© ì¦ëª…ì„ ì‚¬ìš©í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ë¥¼ ì‹¤í–‰**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```
runas /user:domain\username /netonly cmd.exe
```
### í† í° ìœ í˜•

ë‘ ê°€ì§€ ìœ í˜•ì˜ í† í°ì´ ìˆìŠµë‹ˆë‹¤:

- **ê¸°ë³¸ í† í°(Primary Token)**: í”„ë¡œì„¸ìŠ¤ì˜ ë³´ì•ˆ ìê²© ì¦ëª…ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ê¸°ë³¸ í† í°ì˜ ìƒì„± ë° í”„ë¡œì„¸ìŠ¤ì™€ì˜ ì—°ê´€ì€ ê¶Œí•œì„ ìƒìŠ¹ì‹œí‚¤ëŠ” ì‘ì—…ìœ¼ë¡œ, ê¶Œí•œ ë¶„ë¦¬ì˜ ì›ì¹™ì„ ê°•ì¡°í•©ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ì¸ì¦ ì„œë¹„ìŠ¤ê°€ í† í° ìƒì„±ì„ ë‹´ë‹¹í•˜ë©°, ë¡œê·¸ì˜¨ ì„œë¹„ìŠ¤ê°€ ì‚¬ìš©ìì˜ ìš´ì˜ ì²´ì œ ì…¸ê³¼ì˜ ì—°ê´€ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤. í”„ë¡œì„¸ìŠ¤ëŠ” ìƒì„± ì‹œ ë¶€ëª¨ í”„ë¡œì„¸ìŠ¤ì˜ ê¸°ë³¸ í† í°ì„ ìƒì†ë°›ìŠµë‹ˆë‹¤.
- **ì„í„ìŠ¨ í† í°(Impersonation Token)**: ì„œë²„ ì‘ìš© í”„ë¡œê·¸ë¨ì´ ì•ˆì „í•œ ê°œì²´ì— ì•¡ì„¸ìŠ¤í•˜ê¸° ìœ„í•´ ì¼ì‹œì ìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ì˜ ì‹ ì›ì„ ì·¨í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤. ì´ ë©”ì»¤ë‹ˆì¦˜ì€ ë„¤ ê°€ì§€ ìˆ˜ì¤€ì˜ ì‘ë™ìœ¼ë¡œ ë‚˜ë‰©ë‹ˆë‹¤:
  - **ìµëª…(Anonymous)**: ì‹ë³„ë˜ì§€ ì•Šì€ ì‚¬ìš©ìì™€ ìœ ì‚¬í•œ ì„œë²„ ì•¡ì„¸ìŠ¤ë¥¼ ë¶€ì—¬í•©ë‹ˆë‹¤.
  - **ì‹ë³„(Identification)**: ê°œì²´ ì•¡ì„¸ìŠ¤ì— ì‚¬ìš©í•˜ì§€ ì•Šê³  í´ë¼ì´ì–¸íŠ¸ì˜ ì‹ ì›ì„ í™•ì¸í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.
  - **ì„í„ìŠ¨(Impersonation)**: ì„œë²„ê°€ í´ë¼ì´ì–¸íŠ¸ì˜ ì‹ ì›ìœ¼ë¡œ ì‘ë™í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.
  - **ìœ„ì„(Delegation)**: ì„í„ìŠ¨ê³¼ ìœ ì‚¬í•˜ì§€ë§Œ, ì„œë²„ê°€ ìƒí˜¸ ì‘ìš©í•˜ëŠ” ì›ê²© ì‹œìŠ¤í…œì— ì´ ì‹ ì› ê°€ì •ì„ í™•ì¥í•  ìˆ˜ ìˆì–´ ìê²© ì¦ëª…ì„ ë³´ì¡´í•©ë‹ˆë‹¤.

#### í† í° ì„í„ìŠ¨

ë©”íƒ€ìŠ¤í”Œë¡œì‡ì˜ _**incognito**_ ëª¨ë“ˆì„ ì‚¬ìš©í•˜ì—¬ ì¶©ë¶„í•œ ê¶Œí•œì´ ìˆë‹¤ë©´ ë‹¤ë¥¸ **í† í°**ì„ **ëª©ë¡í™”**í•˜ê³  **ì„í„ìŠ¨**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ **ë‹¤ë¥¸ ì‚¬ìš©ìì¸ ê²ƒì²˜ëŸ¼ ì‘ì—…**ì„ ìˆ˜í–‰í•˜ëŠ” ë° ìœ ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ ì´ ê¸°ìˆ ì„ ì‚¬ìš©í•˜ì—¬ **ê¶Œí•œ ìƒìŠ¹**ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.

### í† í° ê¶Œí•œ

**ê¶Œí•œ ìƒìŠ¹ì— ì•…ìš©ë  ìˆ˜ ìˆëŠ” í† í° ê¶Œí•œì„ ì•Œì•„ë´…ë‹ˆë‹¤:**

{% content-ref url="privilege-escalation-abusing-tokens.md" %}
[privilege-escalation-abusing-tokens.md](privilege-escalation-abusing-tokens.md)
{% endcontent-ref %}

[**ëª¨ë“  ê°€ëŠ¥í•œ í† í° ê¶Œí•œ ë° ì´ì— ëŒ€í•œ ì •ì˜ë¥¼ í™•ì¸í•˜ì„¸ìš”**](https://github.com/gtworek/Priv2Admin)ì—ì„œ.

## ì°¸ê³  ìë£Œ

ë‹¤ìŒ ììŠµì„œì—ì„œ í† í°ì— ëŒ€í•´ ë” ì•Œì•„ë³´ì„¸ìš”: [https://medium.com/@seemant.bisht24/understanding-and-abusing-process-tokens-part-i-ee51671f2cfa](https://medium.com/@seemant.bisht24/understanding-and-abusing-process-tokens-part-i-ee51671f2cfa) ë° [https://medium.com/@seemant.bisht24/understanding-and-abusing-access-tokens-part-ii-b9069f432962](https://medium.com/@seemant.bisht24/understanding-and-abusing-access-tokens-part-ii-b9069f432962)

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io)ì€ **ë‹¤í¬ ì›¹**ì„ ê¸°ë°˜ìœ¼ë¡œ í•œ ê²€ìƒ‰ ì—”ì§„ìœ¼ë¡œ, íšŒì‚¬ë‚˜ ê·¸ ê³ ê°ì´ **ìŠ¤í‹¸ëŸ¬ ì•…ì„± ì†Œí”„íŠ¸ì›¨ì–´**ì— ì˜í•´ **ì¹¨í•´**ë‹¹í–ˆëŠ”ì§€ í™•ì¸í•˜ëŠ” **ë¬´ë£Œ** ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

WhiteIntelì˜ ì£¼ìš” ëª©í‘œëŠ” ì •ë³´ íƒˆì·¨ ì•…ì„± ì†Œí”„íŠ¸ì›¨ì–´ë¡œ ì¸í•œ ê³„ì • íƒˆì·¨ ë° ëœì„¬ì›¨ì–´ ê³µê²©ì— ëŒ€í•­í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

ê·¸ë“¤ì˜ ì›¹ì‚¬ì´íŠ¸ë¥¼ ë°©ë¬¸í•˜ì—¬ **ë¬´ë£Œ**ë¡œ ì—”ì§„ì„ ì‹œë„í•´ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% embed url="https://whiteintel.io" %}

<details>

<summary><strong>ì œë¡œë¶€í„° ì˜ì›…ì´ ë  ë•Œê¹Œì§€ AWS í•´í‚¹ì„ ë°°ìš°ì„¸ìš”</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* **ì‚¬ì´ë²„ ë³´ì•ˆ íšŒì‚¬ì—ì„œ ì¼í•˜ì‹œë‚˜ìš”? ê·€í•˜ì˜ íšŒì‚¬ë¥¼ HackTricksì—ì„œ ê´‘ê³ í•˜ê³  ì‹¶ìœ¼ì‹ ê°€ìš”? ë˜ëŠ” PEASSì˜ ìµœì‹  ë²„ì „ì— ì•¡ì„¸ìŠ¤í•˜ê±°ë‚˜ HackTricksë¥¼ PDFë¡œ ë‹¤ìš´ë¡œë“œí•˜ê³  ì‹¶ìœ¼ì‹ ê°€ìš”? [**êµ¬ë… ìš”ê¸ˆì œ**](https://github.com/sponsors/carlospolop)ë¥¼ í™•ì¸í•˜ì„¸ìš”!**
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ë¥¼ ë°œê²¬í•˜ì„¸ìš”, ì €í¬ì˜ ë…ì  [**NFTs**](https://opensea.io/collection/the-peass-family) ì»¬ë ‰ì…˜
* [**ê³µì‹ PEASS & HackTricks ìŠ¤ì™œê·¸**](https://peass.creator-spring.com)ë¥¼ ì–»ìœ¼ì„¸ìš”
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**ë””ìŠ¤ì½”ë“œ ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— **ê°€ì…**í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ë ¤ë©´ PRì„** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ë°** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ì— ì œì¶œí•˜ì„¸ìš”.**

</details>
